<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="John Carl Tagbor">

<title>Model Bank: Data-Driven Insights into Asset-Liability Management</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Model Bank Data Analysis and Visualizations_files/libs/clipboard/clipboard.min.js"></script>
<script src="Model Bank Data Analysis and Visualizations_files/libs/quarto-html/quarto.js"></script>
<script src="Model Bank Data Analysis and Visualizations_files/libs/quarto-html/popper.min.js"></script>
<script src="Model Bank Data Analysis and Visualizations_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Model Bank Data Analysis and Visualizations_files/libs/quarto-html/anchor.min.js"></script>
<link href="Model Bank Data Analysis and Visualizations_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Model Bank Data Analysis and Visualizations_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Model Bank Data Analysis and Visualizations_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Model Bank Data Analysis and Visualizations_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Model Bank Data Analysis and Visualizations_files/libs/bootstrap/bootstrap-a1ff8711b79ae3724c050874b28d9907.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#project-objectives" id="toc-project-objectives" class="nav-link" data-scroll-target="#project-objectives">Project Objectives</a></li>
  <li><a href="#data-generation-with-python" id="toc-data-generation-with-python" class="nav-link" data-scroll-target="#data-generation-with-python">Data Generation with Python</a>
  <ul class="collapse">
  <li><a href="#python-libraries-used" id="toc-python-libraries-used" class="nav-link" data-scroll-target="#python-libraries-used">Python Libraries Used</a></li>
  <li><a href="#key-data-elements" id="toc-key-data-elements" class="nav-link" data-scroll-target="#key-data-elements">Key Data Elements</a></li>
  </ul></li>
  <li><a href="#python-code-for-liability-data-generation" id="toc-python-code-for-liability-data-generation" class="nav-link" data-scroll-target="#python-code-for-liability-data-generation">Python Code for Liability Data Generation</a></li>
  <li><a href="#data-dictionary---liability" id="toc-data-dictionary---liability" class="nav-link" data-scroll-target="#data-dictionary---liability">Data Dictionary - Liability</a></li>
  <li><a href="#python-code-for-asset-data-generation" id="toc-python-code-for-asset-data-generation" class="nav-link" data-scroll-target="#python-code-for-asset-data-generation">Python Code for Asset Data Generation</a></li>
  <li><a href="#data-dictionary---asset" id="toc-data-dictionary---asset" class="nav-link" data-scroll-target="#data-dictionary---asset">Data Dictionary - Asset</a></li>
  <li><a href="#next-steps-data-visualization" id="toc-next-steps-data-visualization" class="nav-link" data-scroll-target="#next-steps-data-visualization">Next Steps: Data Visualization</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Model Bank: Data-Driven Insights into Asset-Liability Management</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>John Carl Tagbor </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>This portfolio project demonstrates my skills in data analysis, data visualization, and financial modeling, focusing on Asset-Liability Management (ALM) principles. The project centers around a simulated dataset representing the assets and liabilities of a fictional bank, “Model Bank,” to create a realistic foundation for generating insights.</p>
<section id="project-objectives" class="level2">
<h2 class="anchored" data-anchor-id="project-objectives">Project Objectives</h2>
<p>The key objectives of this project include:</p>
<ul>
<li><strong>Realistic Data Generation:</strong> Creating comprehensive datasets for Model Bank’s asset and liability portfolios. This data is assumed to be a sbapshop at an arbitrary date</li>
<li><strong>Data Analysis and Insights:</strong> Applying analytical techniques to uncover trends, risks, and opportunities within the generated data.</li>
<li><strong>Visualization and Communication:</strong> Developing interactive dashboards and visualizations to effectively communicate key ALM concepts and insights.</li>
</ul>
</section>
<section id="data-generation-with-python" class="level2">
<h2 class="anchored" data-anchor-id="data-generation-with-python">Data Generation with Python</h2>
<p>I used Python to generate the dummy data for Model Bank’s assets and liabilities. This involved defining key attributes for various financial products. The code generates the CSV files which are then used as the data source for the visualizations.</p>
<section id="python-libraries-used" class="level3">
<h3 class="anchored" data-anchor-id="python-libraries-used">Python Libraries Used</h3>
<ul>
<li><code>csv</code>: For reading/writing CSV files.</li>
<li><code>random</code>: For generating random data, such as amounts, interest rates, and customer demographics.</li>
<li><code>datetime</code>: For date calculations.</li>
</ul>
</section>
<section id="key-data-elements" class="level3">
<h3 class="anchored" data-anchor-id="key-data-elements">Key Data Elements</h3>
<ul>
<li>Liabilities:
<ul>
<li>Fixed Deposits</li>
<li>Corporate Current Accounts</li>
<li>Retail Current Accounts</li>
<li>Savings Accounts (various types)</li>
<li>Borrowings (Short- and Long-Term)</li>
</ul></li>
<li>Assets:
<ul>
<li>Overdrafts</li>
<li>Corporate Loans</li>
<li>Retail Loans</li>
<li>Student Loans</li>
<li>Employee Loans</li>
<li>Auto Loans</li>
<li>Credit Card Loans</li>
<li>USD Treasury Bill Securities (various tenors)</li>
<li>Cash (at branches and the Federal Reserve)</li>
<li>Placements with Other Banks</li>
</ul></li>
</ul>
</section>
</section>
<section id="python-code-for-liability-data-generation" class="level2">
<h2 class="anchored" data-anchor-id="python-code-for-liability-data-generation">Python Code for Liability Data Generation</h2>
<div id="7e614795" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>random.seed(<span class="dv">42</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_deal_id(product_initials):</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>product_initials<span class="sc">}{</span><span class="st">''</span><span class="sc">.</span>join([<span class="bu">str</span>(random.randint(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">12</span>)])<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_customer_id():</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>random<span class="sc">.</span>randint(<span class="dv">1</span>, <span class="dv">400000</span>)<span class="sc">:06d}</span><span class="ss">"</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_date(start_year, end_year):</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    start_date <span class="op">=</span> datetime(start_year, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    end_date <span class="op">=</span> datetime(end_year, <span class="dv">12</span>, <span class="dv">31</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (start_date <span class="op">+</span> timedelta(days<span class="op">=</span>random.randint(<span class="dv">0</span>, (end_date <span class="op">-</span> start_date).days))).strftime(<span class="st">"%m/</span><span class="sc">%d</span><span class="st">/%Y"</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_dataset(num_records, num_customers):</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    products <span class="op">=</span> {</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"FD"</span>: <span class="st">"Fixed Deposits"</span>,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"CC"</span>: <span class="st">"Corporate Current Account"</span>,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"RC"</span>: <span class="st">"Retail Current Account"</span>,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SS"</span>: <span class="st">"Student Savings Account"</span>,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"PS"</span>: <span class="st">"Personal Savings Account"</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ES"</span>: <span class="st">"Employee Savings Account"</span>,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SB"</span>: <span class="st">"Short Term Borrowings"</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">"LB"</span>: <span class="st">"Long Term Borrowings"</span>,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HB"</span>: <span class="st">"Hybrid Account"</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    currencies <span class="op">=</span> [<span class="st">"USD"</span>, <span class="st">"GBP"</span>, <span class="st">"EUR"</span>]</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    genders <span class="op">=</span> [<span class="st">"Male"</span>, <span class="st">"Female"</span>]</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    branches <span class="op">=</span> [</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AL'</span>, <span class="st">'AK'</span>, <span class="st">'AZ'</span>, <span class="st">'AR'</span>, <span class="st">'CA'</span>, <span class="st">'CO'</span>, <span class="st">'CT'</span>, <span class="st">'DE'</span>, <span class="st">'FL'</span>, <span class="st">'GA'</span>, </span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">'HI'</span>, <span class="st">'ID'</span>, <span class="st">'IL'</span>, <span class="st">'IN'</span>, <span class="st">'IA'</span>, <span class="st">'KS'</span>, <span class="st">'KY'</span>, <span class="st">'LA'</span>, <span class="st">'ME'</span>, <span class="st">'MD'</span>,</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MA'</span>, <span class="st">'MI'</span>, <span class="st">'MN'</span>, <span class="st">'MS'</span>, <span class="st">'MO'</span>, <span class="st">'MT'</span>, <span class="st">'NE'</span>, <span class="st">'NV'</span>, <span class="st">'NH'</span>, <span class="st">'NJ'</span>,</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">'NM'</span>, <span class="st">'NY'</span>, <span class="st">'NC'</span>, <span class="st">'ND'</span>, <span class="st">'OH'</span>, <span class="st">'OK'</span>, <span class="st">'OR'</span>, <span class="st">'PA'</span>, <span class="st">'RI'</span>, <span class="st">'SC'</span>,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">'SD'</span>, <span class="st">'TN'</span>, <span class="st">'TX'</span>, <span class="st">'UT'</span>, <span class="st">'VT'</span>, <span class="st">'VA'</span>, <span class="st">'WA'</span>, <span class="st">'WV'</span>, <span class="st">'WI'</span>, <span class="st">'WY'</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    first_names <span class="op">=</span> [</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Emma"</span>, <span class="st">"Liam"</span>, <span class="st">"Olivia"</span>, <span class="st">"Noah"</span>, <span class="st">"Ava"</span>, <span class="st">"Ethan"</span>, <span class="st">"Sophia"</span>, <span class="st">"Mason"</span>,</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Isabella"</span>, <span class="st">"William"</span>, <span class="st">"Mia"</span>, <span class="st">"James"</span>, <span class="st">"Charlotte"</span>, <span class="st">"Benjamin"</span>, <span class="st">"Amelia"</span>,</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Lucas"</span>, <span class="st">"Harper"</span>, <span class="st">"Henry"</span>, <span class="st">"Evelyn"</span>, <span class="st">"Alexander"</span>, <span class="st">"Abigail"</span>, <span class="st">"Daniel"</span>,</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Emily"</span>, <span class="st">"Matthew"</span>, <span class="st">"Elizabeth"</span>, <span class="st">"Michael"</span>, <span class="st">"Mila"</span>, <span class="st">"Jackson"</span>, <span class="st">"Ella"</span>,</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sebastian"</span>, <span class="st">"Avery"</span>, <span class="st">"David"</span>, <span class="st">"Scarlett"</span>, <span class="st">"Joseph"</span>, <span class="st">"Sofia"</span>, <span class="st">"Carter"</span>,</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Chloe"</span>, <span class="st">"Owen"</span>, <span class="st">"Victoria"</span>, <span class="st">"Wyatt"</span>, <span class="st">"Madison"</span>, <span class="st">"John"</span>, <span class="st">"Grace"</span>, <span class="st">"Jack"</span>,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Zoey"</span>, <span class="st">"Luke"</span>, <span class="st">"Penelope"</span>, <span class="st">"Jayden"</span>, <span class="st">"Riley"</span>, <span class="st">"Dylan"</span>, <span class="st">"Layla"</span>, <span class="st">"Grayson"</span>,</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Lillian"</span>, <span class="st">"Levi"</span>, <span class="st">"Nora"</span>, <span class="st">"Isaac"</span>, <span class="st">"Hazel"</span>, <span class="st">"Gabriel"</span>, <span class="st">"Aubrey"</span>, <span class="st">"Julian"</span>,</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Hannah"</span>, <span class="st">"Mateo"</span>, <span class="st">"Aria"</span>, <span class="st">"Anthony"</span>, <span class="st">"Aurora"</span>, <span class="st">"Jaxon"</span>, <span class="st">"Addison"</span>,</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Lincoln"</span>, <span class="st">"Stella"</span>, <span class="st">"Joshua"</span>, <span class="st">"Natalie"</span>, <span class="st">"Christopher"</span>, <span class="st">"Ellie"</span>, <span class="st">"Andrew"</span>,</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Savannah"</span>, <span class="st">"Theodore"</span>, <span class="st">"Audrey"</span>, <span class="st">"Caleb"</span>, <span class="st">"Leah"</span>, <span class="st">"Ryan"</span>, <span class="st">"Camila"</span>,</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Asher"</span>, <span class="st">"Aaliyah"</span>, <span class="st">"Nathan"</span>, <span class="st">"Skylar"</span>, <span class="st">"Thomas"</span>, <span class="st">"Claire"</span>, <span class="st">"Leo"</span>, <span class="st">"Bella"</span>,</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Isaiah"</span>, <span class="st">"Lucy"</span>, <span class="st">"Charles"</span>, <span class="st">"Eleanor"</span>, <span class="st">"Josiah"</span>, <span class="st">"Violet"</span>, <span class="st">"Hudson"</span>,</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Paisley"</span>, <span class="st">"Christian"</span>, <span class="st">"Kennedy"</span>, <span class="st">"Hunter"</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    last_names <span class="op">=</span> [</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Smith"</span>, <span class="st">"Johnson"</span>, <span class="st">"Williams"</span>, <span class="st">"Brown"</span>, <span class="st">"Jones"</span>, <span class="st">"Garcia"</span>, <span class="st">"Miller"</span>,</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Davis"</span>, <span class="st">"Rodriguez"</span>, <span class="st">"Martinez"</span>, <span class="st">"Hernandez"</span>, <span class="st">"Lopez"</span>, <span class="st">"Gonzalez"</span>,</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Wilson"</span>, <span class="st">"Anderson"</span>, <span class="st">"Thomas"</span>, <span class="st">"Taylor"</span>, <span class="st">"Moore"</span>, <span class="st">"Jackson"</span>, <span class="st">"Martin"</span>,</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Lee"</span>, <span class="st">"Perez"</span>, <span class="st">"Thompson"</span>, <span class="st">"White"</span>, <span class="st">"Harris"</span>, <span class="st">"Sanchez"</span>, <span class="st">"Clark"</span>,</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Ramirez"</span>, <span class="st">"Lewis"</span>, <span class="st">"Robinson"</span>, <span class="st">"Walker"</span>, <span class="st">"Young"</span>, <span class="st">"Allen"</span>, <span class="st">"King"</span>,</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Wright"</span>, <span class="st">"Scott"</span>, <span class="st">"Torres"</span>, <span class="st">"Nguyen"</span>, <span class="st">"Hill"</span>, <span class="st">"Flores"</span>, <span class="st">"Green"</span>, <span class="st">"Adams"</span>,</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Nelson"</span>, <span class="st">"Baker"</span>, <span class="st">"Hall"</span>, <span class="st">"Rivera"</span>, <span class="st">"Campbell"</span>, <span class="st">"Mitchell"</span>, <span class="st">"Carter"</span>,</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Roberts"</span>, <span class="st">"Gomez"</span>, <span class="st">"Phillips"</span>, <span class="st">"Evans"</span>, <span class="st">"Turner"</span>, <span class="st">"Diaz"</span>, <span class="st">"Parker"</span>, </span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Cruz"</span>, <span class="st">"Edwards"</span>, <span class="st">"Collins"</span>, <span class="st">"Reyes"</span>, <span class="st">"Stewart"</span>, <span class="st">"Morris"</span>, <span class="st">"Morales"</span>,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Murphy"</span>, <span class="st">"Cook"</span>, <span class="st">"Rogers"</span>, <span class="st">"Gutierrez"</span>, <span class="st">"Ortiz"</span>, <span class="st">"Morgan"</span>, <span class="st">"Cooper"</span>,</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Peterson"</span>, <span class="st">"Bailey"</span>, <span class="st">"Reed"</span>, <span class="st">"Kelly"</span>, <span class="st">"Howard"</span>, <span class="st">"Ramos"</span>, <span class="st">"Kim"</span>, <span class="st">"Cox"</span>,</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Ward"</span>, <span class="st">"Richardson"</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>    customers <span class="op">=</span> [generate_customer_id() <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_customers)]</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    customer_data <span class="op">=</span> {customer: {</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>        <span class="st">"name"</span>: <span class="ss">f"</span><span class="sc">{</span>random<span class="sc">.</span>choice(first_names)<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>random<span class="sc">.</span>choice(last_names)<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>        <span class="st">"dob"</span>: generate_date(<span class="dv">1925</span>, <span class="dv">2005</span>),</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>        <span class="st">"gender"</span>: random.choice(genders)</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">for</span> customer <span class="kw">in</span> customers}</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">'bank_liability_products_new252.csv'</span>, <span class="st">'w'</span>, newline<span class="op">=</span><span class="st">''</span>) <span class="im">as</span> csvfile:</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>        fieldnames <span class="op">=</span> [<span class="st">"DEAL_ID"</span>, <span class="st">"CUSTOMER_ID"</span>, <span class="st">"PRODUCT_NAME"</span>, <span class="st">"CUSTOMER_NAME"</span>,</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>        <span class="st">"CUSTOMER_DOB"</span>, <span class="st">"CUSTOMER_GENDER"</span>, <span class="st">"CURRENCY"</span>, <span class="st">"AMOUNT"</span>, <span class="st">"DEAL_RATE"</span>,</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>        <span class="st">"VALUE_DATE"</span>, <span class="st">"MAT_DATE"</span>, <span class="st">"BRANCH"</span>, <span class="st">"PRODUCT_INITIALS"</span>, <span class="st">"PRODUCT_TYPE"</span>]</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>        writer <span class="op">=</span> csv.DictWriter(csvfile, fieldnames<span class="op">=</span>fieldnames)</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>        writer.writeheader()</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_records):</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>            customer_id <span class="op">=</span> random.choice(customers)</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>            product_initials, product_name <span class="op">=</span> random.choice(<span class="bu">list</span>(products.items()))</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>            deal_id <span class="op">=</span> generate_deal_id(product_initials)</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>            row <span class="op">=</span> {</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>                <span class="st">"DEAL_ID"</span>: deal_id,</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_ID"</span>: customer_id,</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>                <span class="st">"PRODUCT_NAME"</span>: product_name,</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_NAME"</span>: customer_data[customer_id][<span class="st">"name"</span>],</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_DOB"</span>: customer_data[customer_id][<span class="st">"dob"</span>],</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_GENDER"</span>: customer_data[customer_id][<span class="st">"gender"</span>],</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CURRENCY"</span>: random.choice(currencies),</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>                <span class="st">"AMOUNT"</span>: <span class="bu">round</span>(random.uniform(<span class="dv">0</span>, <span class="dv">50000</span>), <span class="dv">2</span>),</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>                <span class="st">"DEAL_RATE"</span>: <span class="bu">round</span>(random.uniform(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dv">2</span>),</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>                <span class="st">"VALUE_DATE"</span>: generate_date(<span class="dv">1990</span>, <span class="dv">2024</span>),</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>                <span class="st">"MAT_DATE"</span>: generate_date(<span class="dv">2025</span>, <span class="dv">2030</span>),</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>                <span class="st">"BRANCH"</span>: random.choice(branches),</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>                <span class="st">"PRODUCT_INITIALS"</span>: product_initials,</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>                <span class="st">"PRODUCT_TYPE"</span>: <span class="st">"Time"</span> <span class="cf">if</span> product_initials <span class="kw">in</span> [<span class="st">"FD"</span>, <span class="st">"SB"</span>, <span class="st">"LB"</span>] <span class="cf">else</span> <span class="st">"Non Time"</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>            writer.writerow(row)</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>generate_dataset(<span class="dv">500000</span>, <span class="dv">400000</span>)</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Dataset generated successfully."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Dataset generated successfully.</code></pre>
</div>
</div>
</section>
<section id="data-dictionary---liability" class="level2">
<h2 class="anchored" data-anchor-id="data-dictionary---liability">Data Dictionary - Liability</h2>
<p>The data dictionary defines each column generated in the liability dataset, explaining its purpose and format.</p>
<ul>
<li><strong>DEAL_ID</strong>: A unique identifier for the liability transaction, generated by combining product initials and a random 12-digit number.</li>
</ul>
<!-- -->
<ul>
<li><p><strong>CUSTOMER_ID</strong>: A unique 6-digit identifier for each customer, randomly generated.</p></li>
<li><p><strong>PRODUCT_NAME</strong>: The name of the liability product, selected from predefined product categories like Fixed Deposits, Current Accounts, etc.</p></li>
<li><p><strong>CUSTOMER_NAME</strong>: A randomly generated customer name, combining a first name and a last name from predefined lists.</p></li>
<li><p><strong>CUSTOMER_DOB</strong>: A randomly generated date of birth for the customer, between 1925 and 2005.</p></li>
<li><p><strong>CUSTOMER_GENDER</strong>: Randomly assigned gender for the customer, either “Male” or “Female.”</p></li>
<li><p><strong>CURRENCY</strong>: The currency type for the liability transaction, randomly selected from USD, GBP, or EUR.</p></li>
<li><p><strong>AMOUNT</strong>: The liability amount, randomly generated between 0 and 50,000.</p></li>
<li><p><strong>DEAL_RATE</strong>: The interest rate for the liability, based on product type, randomly generated within defined ranges.</p></li>
<li><p><strong>VALUE_DATE</strong>: The date when the liability transaction was initiated, randomly selected between 1990 and 2024.</p></li>
<li><p><strong>MAT_DATE</strong>: The maturity date for the liability, randomly selected between 2025 and 2030.</p></li>
<li><p><strong>BRANCH</strong>: The branch identifier, selected randomly from a list of U.S. state abbreviations.</p></li>
<li><p><strong>PRODUCT_INITIALS</strong>: The initials for the liability product (e.g., FD for Fixed Deposits, CC for Current Accounts).</p></li>
<li><p><strong>PRODUCT_TYPE</strong>: Defines whether the product is time-based (e.g., Fixed Deposits) or non-time-based (e.g., Current Accounts).</p></li>
</ul>
</section>
<section id="python-code-for-asset-data-generation" class="level2">
<h2 class="anchored" data-anchor-id="python-code-for-asset-data-generation">Python Code for Asset Data Generation</h2>
<div id="5afae083" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>random.seed(<span class="dv">42</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_deal_id(product_initials):</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>product_initials<span class="sc">}{</span><span class="st">''</span><span class="sc">.</span>join([<span class="bu">str</span>(random.randint(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">12</span>)])<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_cash_id(state_abbr):</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>state_abbr<span class="sc">}{</span>random<span class="sc">.</span>randint(<span class="dv">1000</span>, <span class="dv">9999</span>)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_treasury_id(tenor):</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    issue_date <span class="op">=</span> datetime.now().strftime(<span class="st">"%y%m</span><span class="sc">%d</span><span class="st">"</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    cusip <span class="op">=</span> <span class="st">''</span>.join([<span class="bu">str</span>(random.randint(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>)])</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>tenor<span class="sc">.</span>replace(<span class="st">' '</span>, <span class="st">''</span>)<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>issue_date<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>cusip<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_customer_id():</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>random<span class="sc">.</span>randint(<span class="dv">1</span>, <span class="dv">400000</span>)<span class="sc">:06d}</span><span class="ss">"</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_date(start_year, end_year):</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    start_date <span class="op">=</span> datetime(start_year, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    end_date <span class="op">=</span> datetime(end_year, <span class="dv">12</span>, <span class="dv">31</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (start_date <span class="op">+</span> timedelta(days<span class="op">=</span>random.randint(<span class="dv">0</span>, (end_date <span class="op">-</span> start_date).days))).strftime(<span class="st">"%m/</span><span class="sc">%d</span><span class="st">/%Y"</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_deal_rate(product, amount):</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> product <span class="op">==</span> <span class="st">"Overdrafts"</span>:</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">20.00</span> <span class="cf">if</span> random.choice([<span class="va">True</span>, <span class="va">False</span>]) <span class="cf">else</span> <span class="bu">round</span>(random.uniform(<span class="dv">6</span>, <span class="dv">15</span>), <span class="dv">2</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> product <span class="op">==</span> <span class="st">"Employee Loans"</span>:</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">2.00</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> product <span class="op">==</span> <span class="st">"Retail Loans"</span>:</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">round</span>(random.uniform(<span class="dv">6</span>, <span class="dv">15</span>), <span class="dv">2</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> product <span class="op">==</span> <span class="st">"Corporate Loans"</span>:</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">round</span>(random.uniform(<span class="dv">2</span>, <span class="dv">6</span>), <span class="dv">2</span>)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> product <span class="op">==</span> <span class="st">"Cash"</span>:</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">0.00</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="st">"Treasury Bill"</span> <span class="kw">in</span> product:</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">round</span>(random.uniform(<span class="dv">4</span>, <span class="fl">4.8</span>), <span class="dv">2</span>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> product <span class="op">==</span> <span class="st">"Student Loans"</span>:</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">round</span>(random.uniform(<span class="dv">6</span>, <span class="dv">8</span>), <span class="dv">2</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> product <span class="op">==</span> <span class="st">"Auto Loans"</span>:</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">round</span>(random.uniform(<span class="dv">3</span>, <span class="dv">7</span>), <span class="dv">2</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> product <span class="op">==</span> <span class="st">"Credit Card Loans"</span>:</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">round</span>(random.uniform(<span class="dv">15</span>, <span class="dv">25</span>), <span class="dv">2</span>)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">round</span>(random.uniform(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dv">2</span>)</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_dataset(num_records):</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    products <span class="op">=</span> {</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>        <span class="st">"OD"</span>: <span class="st">"Overdrafts"</span>,</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">"CL"</span>: <span class="st">"Corporate Loans"</span>,</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">"RL"</span>: <span class="st">"Retail Loans"</span>,</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SL"</span>: <span class="st">"Student Loans"</span>,</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>        <span class="st">"EL"</span>: <span class="st">"Employee Loans"</span>,</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">"AL"</span>: <span class="st">"Auto Loans"</span>,</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>        <span class="st">"CC"</span>: <span class="st">"Credit Card Loans"</span>,</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>        <span class="st">"TB"</span>: <span class="st">"USD Treasury Bill Securities"</span>,</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>        <span class="st">"CA"</span>: <span class="st">"Cash"</span>,</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>        <span class="st">"PL"</span>: <span class="st">"Placements with other banks"</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>    treasury_tenors <span class="op">=</span> [<span class="st">"1 Mo"</span>, <span class="st">"2 Mo"</span>, <span class="st">"3 Mo"</span>, <span class="st">"4 Mo"</span>, <span class="st">"6 Mo"</span>, <span class="st">"1 Yr"</span>, <span class="st">"2 Yr"</span>, <span class="st">"3 Yr"</span>, <span class="st">"5 Yr"</span>, <span class="st">"7 Yr"</span>, <span class="st">"10 Yr"</span>, <span class="st">"20 Yr"</span>, <span class="st">"30 Yr"</span>]</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    currencies <span class="op">=</span> [<span class="st">"USD"</span>, <span class="st">"GBP"</span>, <span class="st">"EUR"</span>]</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>    genders <span class="op">=</span> [<span class="st">"Male"</span>, <span class="st">"Female"</span>]</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> {</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>        <span class="st">"AL"</span>: <span class="st">"Alabama"</span>, <span class="st">"AK"</span>: <span class="st">"Alaska"</span>, <span class="st">"AZ"</span>: <span class="st">"Arizona"</span>, <span class="st">"AR"</span>: <span class="st">"Arkansas"</span>, <span class="st">"CA"</span>: <span class="st">"California"</span>,</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>        <span class="st">"CO"</span>: <span class="st">"Colorado"</span>, <span class="st">"CT"</span>: <span class="st">"Connecticut"</span>, <span class="st">"DE"</span>: <span class="st">"Delaware"</span>, <span class="st">"FL"</span>: <span class="st">"Florida"</span>, <span class="st">"GA"</span>: <span class="st">"Georgia"</span>,</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HI"</span>: <span class="st">"Hawaii"</span>, <span class="st">"ID"</span>: <span class="st">"Idaho"</span>, <span class="st">"IL"</span>: <span class="st">"Illinois"</span>, <span class="st">"IN"</span>: <span class="st">"Indiana"</span>, <span class="st">"IA"</span>: <span class="st">"Iowa"</span>,</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>        <span class="st">"KS"</span>: <span class="st">"Kansas"</span>, <span class="st">"KY"</span>: <span class="st">"Kentucky"</span>, <span class="st">"LA"</span>: <span class="st">"Louisiana"</span>, <span class="st">"ME"</span>: <span class="st">"Maine"</span>, <span class="st">"MD"</span>: <span class="st">"Maryland"</span>,</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MA"</span>: <span class="st">"Massachusetts"</span>, <span class="st">"MI"</span>: <span class="st">"Michigan"</span>, <span class="st">"MN"</span>: <span class="st">"Minnesota"</span>, <span class="st">"MS"</span>: <span class="st">"Mississippi"</span>, <span class="st">"MO"</span>: <span class="st">"Missouri"</span>,</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MT"</span>: <span class="st">"Montana"</span>, <span class="st">"NE"</span>: <span class="st">"Nebraska"</span>, <span class="st">"NV"</span>: <span class="st">"Nevada"</span>, <span class="st">"NH"</span>: <span class="st">"New Hampshire"</span>, <span class="st">"NJ"</span>: <span class="st">"New Jersey"</span>,</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NM"</span>: <span class="st">"New Mexico"</span>, <span class="st">"NY"</span>: <span class="st">"New York"</span>, <span class="st">"NC"</span>: <span class="st">"North Carolina"</span>, <span class="st">"ND"</span>: <span class="st">"North Dakota"</span>, <span class="st">"OH"</span>: <span class="st">"Ohio"</span>,</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>        <span class="st">"OK"</span>: <span class="st">"Oklahoma"</span>, <span class="st">"OR"</span>: <span class="st">"Oregon"</span>, <span class="st">"PA"</span>: <span class="st">"Pennsylvania"</span>, <span class="st">"RI"</span>: <span class="st">"Rhode Island"</span>, <span class="st">"SC"</span>: <span class="st">"South Carolina"</span>,</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SD"</span>: <span class="st">"South Dakota"</span>, <span class="st">"TN"</span>: <span class="st">"Tennessee"</span>, <span class="st">"TX"</span>: <span class="st">"Texas"</span>, <span class="st">"UT"</span>: <span class="st">"Utah"</span>, <span class="st">"VT"</span>: <span class="st">"Vermont"</span>,</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>        <span class="st">"VA"</span>: <span class="st">"Virginia"</span>, <span class="st">"WA"</span>: <span class="st">"Washington"</span>, <span class="st">"WV"</span>: <span class="st">"West Virginia"</span>, <span class="st">"WI"</span>: <span class="st">"Wisconsin"</span>, <span class="st">"WY"</span>: <span class="st">"Wyoming"</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>    bank_names <span class="op">=</span> [<span class="st">"CitiBank"</span>, <span class="st">"JP Morgan Chase"</span>, <span class="st">"Bank of America"</span>, <span class="st">"Wells Fargo"</span>, <span class="st">"Goldman Sachs"</span>, <span class="st">"Morgan Stanley"</span>, <span class="st">"HSBC"</span>, <span class="st">"Barclays"</span>, <span class="st">"Deutsche Bank"</span>, <span class="st">"UBS"</span>]</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>    first_names <span class="op">=</span> [<span class="st">"Emma"</span>, <span class="st">"Liam"</span>, <span class="st">"Olivia"</span>, <span class="st">"Noah"</span>, <span class="st">"Ava"</span>, <span class="st">"Ethan"</span>, <span class="st">"Sophia"</span>, <span class="st">"Mason"</span>, <span class="st">"Isabella"</span>, <span class="st">"William"</span>]</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>    last_names <span class="op">=</span> [<span class="st">"Smith"</span>, <span class="st">"Johnson"</span>, <span class="st">"Williams"</span>, <span class="st">"Brown"</span>, <span class="st">"Jones"</span>, <span class="st">"Garcia"</span>, <span class="st">"Miller"</span>, <span class="st">"Davis"</span>, <span class="st">"Rodriguez"</span>, <span class="st">"Martinez"</span>]</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>    total_assets <span class="op">=</span> <span class="dv">20_000_000_000</span>  <span class="co"># $20B</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>    cash_allocation <span class="op">=</span> <span class="fl">0.10</span> <span class="op">*</span> total_assets</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>    securities_allocation <span class="op">=</span> <span class="fl">0.35</span> <span class="op">*</span> total_assets</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>    placements_allocation <span class="op">=</span> <span class="fl">0.05</span> <span class="op">*</span> total_assets</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>    loans_allocation <span class="op">=</span> <span class="fl">0.50</span> <span class="op">*</span> total_assets</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">'bank_asset_products25.csv'</span>, <span class="st">'w'</span>, newline<span class="op">=</span><span class="st">''</span>) <span class="im">as</span> csvfile:</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>        fieldnames <span class="op">=</span> [<span class="st">"DEAL_ID"</span>, <span class="st">"CUSTOMER_ID"</span>, <span class="st">"PRODUCT_NAME"</span>, <span class="st">"CUSTOMER_NAME"</span>, <span class="st">"CUSTOMER_DOB"</span>, </span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"CUSTOMER_GENDER"</span>, <span class="st">"CURRENCY"</span>, <span class="st">"AMOUNT"</span>, <span class="st">"DEAL_RATE"</span>, <span class="st">"VALUE_DATE"</span>, </span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"MAT_DATE"</span>, <span class="st">"BRANCH"</span>, <span class="st">"PRODUCT_INITIALS"</span>, <span class="st">"PRODUCT_TYPE"</span>]</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>        writer <span class="op">=</span> csv.DictWriter(csvfile, fieldnames<span class="op">=</span>fieldnames)</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>        writer.writeheader()</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>        remaining_assets <span class="op">=</span> total_assets</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate Cash entries</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> state, full_name <span class="kw">in</span> states.items():</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>            row <span class="op">=</span> {</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>                <span class="st">"DEAL_ID"</span>: generate_cash_id(state),</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_ID"</span>: state,</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>                <span class="st">"PRODUCT_NAME"</span>: <span class="st">"Cash"</span>,</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_NAME"</span>: <span class="ss">f"</span><span class="sc">{</span>full_name<span class="sc">}</span><span class="ss"> Branch"</span>,</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_DOB"</span>: <span class="st">""</span>,</span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_GENDER"</span>: <span class="st">""</span>,</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CURRENCY"</span>: random.choice(currencies),</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>                <span class="st">"AMOUNT"</span>: <span class="bu">round</span>(random.uniform(<span class="dv">1_000_000</span>, <span class="dv">5_000_000</span>), <span class="dv">2</span>),</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>                <span class="st">"DEAL_RATE"</span>: <span class="dv">0</span>,</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>                <span class="st">"VALUE_DATE"</span>: <span class="st">""</span>,</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>                <span class="st">"MAT_DATE"</span>: <span class="st">""</span>,</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>                <span class="st">"BRANCH"</span>: state,</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>                <span class="st">"PRODUCT_INITIALS"</span>: <span class="st">"CA"</span>,</span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>                <span class="st">"PRODUCT_TYPE"</span>: <span class="st">"Non Time"</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>            writer.writerow(row)</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>            remaining_assets <span class="op">-=</span> row[<span class="st">"AMOUNT"</span>]</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Federal Reserve cash entry</span></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>        row <span class="op">=</span> {</span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>            <span class="st">"DEAL_ID"</span>: generate_cash_id(<span class="st">"FED"</span>),</span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>            <span class="st">"CUSTOMER_ID"</span>: <span class="st">"FED"</span>,</span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>            <span class="st">"PRODUCT_NAME"</span>: <span class="st">"Cash"</span>,</span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>            <span class="st">"CUSTOMER_NAME"</span>: <span class="st">"Federal Reserve"</span>,</span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>            <span class="st">"CUSTOMER_DOB"</span>: <span class="st">""</span>,</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>            <span class="st">"CUSTOMER_GENDER"</span>: <span class="st">""</span>,</span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>            <span class="st">"CURRENCY"</span>: <span class="st">"USD"</span>,</span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>            <span class="st">"AMOUNT"</span>: <span class="bu">round</span>(random.uniform(<span class="dv">10_000_000</span>, <span class="dv">50_000_000</span>), <span class="dv">2</span>),</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>            <span class="st">"DEAL_RATE"</span>: <span class="dv">0</span>,</span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>            <span class="st">"VALUE_DATE"</span>: <span class="st">""</span>,</span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>            <span class="st">"MAT_DATE"</span>: <span class="st">""</span>,</span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>            <span class="st">"BRANCH"</span>: <span class="st">"NY"</span>,</span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>            <span class="st">"PRODUCT_INITIALS"</span>: <span class="st">"CA"</span>,</span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>            <span class="st">"PRODUCT_TYPE"</span>: <span class="st">"Non Time"</span></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>        writer.writerow(row)</span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>        remaining_assets <span class="op">-=</span> row[<span class="st">"AMOUNT"</span>]</span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate Securities entries</span></span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">int</span>(securities_allocation <span class="op">/</span> <span class="dv">5_000_000</span>)):</span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>            tenor <span class="op">=</span> random.choice(treasury_tenors)</span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>            row <span class="op">=</span> {</span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>                <span class="st">"DEAL_ID"</span>: generate_treasury_id(tenor),</span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_ID"</span>: <span class="st">"US Treasury"</span>,</span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>                <span class="st">"PRODUCT_NAME"</span>: <span class="ss">f"USD Treasury Bill </span><span class="sc">{</span>tenor<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_NAME"</span>: <span class="st">"US Treasury"</span>,</span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_DOB"</span>: <span class="st">""</span>,</span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_GENDER"</span>: <span class="st">""</span>,</span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CURRENCY"</span>: <span class="st">"USD"</span>,</span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>                <span class="st">"AMOUNT"</span>: <span class="bu">round</span>(random.uniform(<span class="dv">3_000_000</span>, <span class="dv">7_000_000</span>), <span class="dv">2</span>),</span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>                <span class="st">"DEAL_RATE"</span>: get_deal_rate(<span class="st">"USD Treasury Bill"</span>, row[<span class="st">"AMOUNT"</span>]),</span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>                <span class="st">"VALUE_DATE"</span>: generate_date(<span class="dv">2020</span>, <span class="dv">2025</span>),</span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>                <span class="st">"MAT_DATE"</span>: generate_date(<span class="dv">2026</span>, <span class="dv">2055</span>),</span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>                <span class="st">"BRANCH"</span>: random.choice(<span class="bu">list</span>(states.keys())),</span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>                <span class="st">"PRODUCT_INITIALS"</span>: <span class="st">"TB"</span>,</span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>                <span class="st">"PRODUCT_TYPE"</span>: <span class="st">"Time"</span></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>            writer.writerow(row)</span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>            remaining_assets <span class="op">-=</span> row[<span class="st">"AMOUNT"</span>]</span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate Placements entries</span></span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">int</span>(placements_allocation <span class="op">/</span> <span class="dv">1_000_000</span>)):</span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>            bank <span class="op">=</span> random.choice(bank_names)</span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>            value_date <span class="op">=</span> datetime.strptime(generate_date(<span class="dv">2025</span>, <span class="dv">2025</span>), <span class="st">"%m/</span><span class="sc">%d</span><span class="st">/%Y"</span>)</span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>            mat_date <span class="op">=</span> value_date <span class="op">+</span> timedelta(days<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>            row <span class="op">=</span> {</span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>                <span class="st">"DEAL_ID"</span>: generate_deal_id(<span class="st">"PL"</span>),</span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_ID"</span>: bank,</span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>                <span class="st">"PRODUCT_NAME"</span>: <span class="ss">f"Placement with </span><span class="sc">{</span>bank<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_NAME"</span>: bank,</span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_DOB"</span>: <span class="st">""</span>,</span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_GENDER"</span>: <span class="st">""</span>,</span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CURRENCY"</span>: random.choice(currencies),</span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a>                <span class="st">"AMOUNT"</span>: <span class="bu">round</span>(random.uniform(<span class="dv">500_000</span>, <span class="dv">1_500_000</span>), <span class="dv">2</span>),</span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>                <span class="st">"DEAL_RATE"</span>: <span class="bu">round</span>(random.uniform(<span class="fl">0.1</span>, <span class="dv">2</span>), <span class="dv">2</span>),</span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>                <span class="st">"VALUE_DATE"</span>: value_date.strftime(<span class="st">"%m/</span><span class="sc">%d</span><span class="st">/%Y"</span>),</span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>                <span class="st">"MAT_DATE"</span>: mat_date.strftime(<span class="st">"%m/</span><span class="sc">%d</span><span class="st">/%Y"</span>),</span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>                <span class="st">"BRANCH"</span>: random.choice(<span class="bu">list</span>(states.keys())),</span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a>                <span class="st">"PRODUCT_INITIALS"</span>: <span class="st">"PL"</span>,</span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>                <span class="st">"PRODUCT_TYPE"</span>: <span class="st">"Time"</span></span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>            writer.writerow(row)</span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>            remaining_assets <span class="op">-=</span> row[<span class="st">"AMOUNT"</span>]</span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate Loan entries</span></span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> remaining_assets <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a>            product_initials, product_name <span class="op">=</span> random.choice(<span class="bu">list</span>(products.items()))</span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> product_initials <span class="kw">in</span> [<span class="st">"CA"</span>, <span class="st">"TB"</span>, <span class="st">"PL"</span>]:</span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a>            customer_id <span class="op">=</span> generate_customer_id()</span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a>            deal_id <span class="op">=</span> generate_deal_id(product_initials)</span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a>            amount <span class="op">=</span> <span class="bu">round</span>(<span class="bu">min</span>(random.uniform(<span class="dv">1000</span>, <span class="dv">500_000</span>), remaining_assets), <span class="dv">2</span>)</span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a>            row <span class="op">=</span> {</span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a>                <span class="st">"DEAL_ID"</span>: deal_id,</span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_ID"</span>: customer_id,</span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a>                <span class="st">"PRODUCT_NAME"</span>: product_name,</span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_NAME"</span>: <span class="ss">f"</span><span class="sc">{</span>random<span class="sc">.</span>choice(first_names)<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>random<span class="sc">.</span>choice(last_names)<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_DOB"</span>: generate_date(<span class="dv">1925</span>, <span class="dv">2005</span>),</span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CUSTOMER_GENDER"</span>: random.choice(genders),</span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a>                <span class="st">"CURRENCY"</span>: random.choice(currencies),</span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a>                <span class="st">"AMOUNT"</span>: amount,</span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a>                <span class="st">"DEAL_RATE"</span>: get_deal_rate(product_name, amount),</span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a>                <span class="st">"VALUE_DATE"</span>: generate_date(<span class="dv">2020</span>, <span class="dv">2025</span>),</span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a>                <span class="st">"MAT_DATE"</span>: generate_date(<span class="dv">2026</span>, <span class="dv">2035</span>) <span class="cf">if</span> product_name <span class="op">!=</span> <span class="st">"Overdrafts"</span> <span class="kw">or</span> random.choice([<span class="va">True</span>, <span class="va">False</span>]) <span class="cf">else</span> <span class="st">""</span>,</span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a>                <span class="st">"BRANCH"</span>: random.choice(<span class="bu">list</span>(states.keys())),</span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a>                <span class="st">"PRODUCT_INITIALS"</span>: product_initials,</span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a>                <span class="st">"PRODUCT_TYPE"</span>: <span class="st">"Time"</span> <span class="cf">if</span> product_name <span class="op">!=</span> <span class="st">"Overdrafts"</span> <span class="kw">or</span> (row[<span class="st">"MAT_DATE"</span>] <span class="kw">and</span> row[<span class="st">"MAT_DATE"</span>] <span class="op">!=</span> <span class="st">""</span>) <span class="cf">else</span> <span class="st">"Non Time"</span></span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a>            writer.writerow(row)</span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a>            remaining_assets <span class="op">-=</span> row[<span class="st">"AMOUNT"</span>]</span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a>generate_dataset(<span class="dv">500000</span>)</span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Asset dataset generated successfully."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Asset dataset generated successfully.</code></pre>
</div>
</div>
</section>
<section id="data-dictionary---asset" class="level2">
<h2 class="anchored" data-anchor-id="data-dictionary---asset">Data Dictionary - Asset</h2>
<p>The data dictionary defines each column generated in the asset dataset, explaining its purpose and format.</p>
<ul>
<li><strong>DEAL_ID</strong>: A unique identifier for the asset transaction, similar to liabilities, generated by combining product initials and a random 12-digit number.</li>
<li><strong>CUSTOMER_ID</strong>: A unique 6-digit identifier for each customer, randomly generated.</li>
<li><strong>PRODUCT_NAME</strong>: The name of the asset product, selected from predefined categories like Overdrafts, Loans, etc.</li>
<li><strong>CUSTOMER_NAME</strong>: A randomly generated customer name, combining a first and last name.</li>
<li><strong>CUSTOMER_DOB</strong>: A randomly generated date of birth for the customer, between 1925 and 2005.</li>
<li><strong>CUSTOMER_GENDER</strong>: Randomly assigned gender for the customer, either “Male” or “Female.”</li>
<li><strong>CURRENCY</strong>: The currency type for the asset transaction, randomly selected from USD, GBP, or EUR.</li>
<li><strong>AMOUNT</strong>: The asset amount, randomly generated between 0 and 50,000.</li>
<li><strong>DEAL_RATE</strong>: The interest rate for the asset, based on product type, randomly generated within predefined ranges.</li>
<li><strong>VALUE_DATE</strong>: The date when the asset transaction was initiated, randomly selected between 1990 and 2024.</li>
<li><strong>MAT_DATE</strong>: The maturity date for the asset, randomly selected between 2025 and 2030.</li>
<li><strong>BRANCH</strong>: The branch identifier, selected randomly from a list of U.S. state abbreviations.</li>
<li><strong>PRODUCT_INITIALS</strong>: The initials for the asset product (e.g., OD for Overdrafts, CL for Corporate Loans).</li>
<li><strong>PRODUCT_TYPE</strong>: Defines whether the asset product is time-based (e.g., Loans) or non-time-based (e.g., Overdrafts).</li>
</ul>
</section>
<section id="next-steps-data-visualization" class="level2">
<h2 class="anchored" data-anchor-id="next-steps-data-visualization">Next Steps: Data Visualization</h2>
<p>The generated data forms the basis for interactive visualizations created using Power BI with some slight data cleanup deployed in Power Query Editor. These visualizations are shown by using this link below:</p>
<p><a href="https://app.powerbi.com/view?r=eyJrIjoiMzc1NzA2ZTQtMDBiOS00MDJhLWFkOGItNmI5ZTExZGE5ODM0IiwidCI6ImI5M2NiYzNlLTY2MWQtNDA1OC04NjkzLWE4OTdiOTI0YjhkNyIsImMiOjF9">Check out my dashboard here</a></p>
<p>I would use this PowerBI dashboard to show,</p>
<ul>
<li>Asset and Liability Composition: Understanding the breakdown of Model Bank’s portfolio.</li>
<li>Interest Rate Risk: Analyzing the potential impact of changing interest rates on the bank’s earnings.</li>
<li>Liquidity Risk: Assessing the bank’s ability to meet its short-term obligations.</li>
</ul>
<p>This dashboard is meant to provide real time information to business managers for quicj and easy decision making.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>