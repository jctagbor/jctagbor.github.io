<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Molly McDade | Ann Gray Perdue | Luke White | John Carl Tagbor">

<title>TIME SERIES FORECASTING OF HERSHEY NET SALES &amp; COST OF SALES.</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Hershey_files/libs/clipboard/clipboard.min.js"></script>
<script src="Hershey_files/libs/quarto-html/quarto.js"></script>
<script src="Hershey_files/libs/quarto-html/popper.min.js"></script>
<script src="Hershey_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Hershey_files/libs/quarto-html/anchor.min.js"></script>
<link href="Hershey_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Hershey_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Hershey_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Hershey_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Hershey_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">TIME SERIES FORECASTING OF HERSHEY NET SALES &amp; COST OF SALES.</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Molly McDade | Ann Gray Perdue | Luke White | John Carl Tagbor </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction-and-company-overview" class="level2">
<h2 class="anchored" data-anchor-id="introduction-and-company-overview">1. Introduction and Company Overview</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://1000logos.net/wp-content/uploads/2020/07/Hershey-Logo.png" class="centre img-fluid figure-img" style="width:30.0%"></p>
<figcaption>Hershey Logo</figcaption>
</figure>
</div>
<section id="company-background" class="level3">
<h3 class="anchored" data-anchor-id="company-background">Company Background:</h3>
<p>Hershey is a leading company in the confectionery industry, known for producing chocolate, candy, mints, and other snack foods. Founded in 1894 by Milton Hershey, the company is headquartered in Hershey, Pennsylvania.</p>
<p>Hershey’s mission is to bring moments of goodness to people by delivering quality confectionery products. Its key products include the iconic Hershey’s Chocolate Bar, Reese’s Peanut Butter Cups, and Kisses. The company also produces a wide range of snacks, baking products, and beverages.</p>
<p>Hershey operates in both domestic and international markets, with its primary revenue coming from North America. It faces competition from companies like Mars, Nestlé, and Mondelez International.</p>
</section>
<section id="motivation-for-variables" class="level3">
<h3 class="anchored" data-anchor-id="motivation-for-variables">Motivation for Variables:</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cloudfront-us-east-2.images.arcpublishing.com/reuters/V4HHTJY775JYHMTBQHEPICKZZI.jpg" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Hershey Product Sales</figcaption>
</figure>
</div>
<p><strong>Net Sales:</strong></p>
<p>– Net sales represent the total revenue from Hershey’s products after deductions for discounts, allowances, and returns. This variable is a critical indicator of Hershey’s financial performance as it reflects the company’s ability to generate income from its operations.</p>
<p>– Net sales are influenced by market demand, seasonality, product innovation, and Hershey’s ability to expand into new markets. Understanding future net sales can help predict overall company growth and market share.</p>
<p><strong>Cost of Sales:</strong></p>
<p>– The cost of sales represents the direct costs associated with producing and delivering Hershey’s products. This includes expenses such as raw materials (ex: cocoa, sugar, dairy), labor, and manufacturing overhead.</p>
<p>– Tracking and forecasting the cost of sales is essential to assessing profitability. If costs rise faster than sales, it could squeeze profit margins. Forecasting this variable helps Hershey plan for cost control strategies and maintain operational efficiency.</p>
</section>
</section>
<section id="data-and-key-insights" class="level2">
<h2 class="anchored" data-anchor-id="data-and-key-insights">2. Data and Key Insights</h2>
<section id="data-source" class="level3">
<h3 class="anchored" data-anchor-id="data-source">Data Source:</h3>
<p>The data for this analysis was sourced directly from Hershey’s quarterly earnings releases, available on the company’s investor relations website at Hershey Investor Relations. The earnings releases provide detailed insights into Hershey’s financial performance, including key metrics such as net sales and cost of sales. These financial statements are publicly available and serve as a reliable source of up-to-date company data.</p>
<p>You can view the individual reports <a href="https://investors.thehersheycompany.com/en_us/home/reports-and-filings/quarterly-reports.html">here</a>. <br></p>
</section>
<section id="initial-observations" class="level3">
<h3 class="anchored" data-anchor-id="initial-observations">Initial Observations:</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.foodbusinessnews.net/ext/resources/2020/11/HersheyHalloween_Lead.jpg?height=900&amp;t=1604939681&amp;width=900" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Halloween</figcaption>
</figure>
</div>
<p><strong>Seasonality in sales:</strong> One notable observation in Hershey’s financial data is the pronounced seasonality of its sales. As outlined in the company’s reports, higher net sales are often recorded during specific periods of the year, particularly around major holidays such as Halloween, Christmas, and Easter. These holidays typically drive increased demand for Hershey’s confectionery products.</p>
<p><strong>Net Sales Growth:</strong> Over the last few years, Hershey has experienced a steady growth in net sales, partly due to product innovation, pricing strategies, and the company’s ability to expand into new markets. This upward trend aligns with the broader growth in the snack and confectionery industry.</p>
<p><strong>Cost of Sales Fluctuations:</strong> The cost of sales has shown periodic fluctuations, driven by factors such as changes in raw material prices (especially cocoa, sugar, and dairy), supply chain constraints, and rising labor costs. There’s a clear relationship between commodity price volatility and cost of sales, which has implications for Hershey’s overall profitability.</p>
<p><strong>Anomalies:</strong> One anomaly noted in the financial data is the impact of the COVID-19 pandemic on sales and costs in early 2020, when demand for certain products temporarily shifted, and supply chains were disrupted. <br></p>
</section>
</section>
<section id="descriptive-statistics" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-statistics">3. Descriptive Statistics</h2>
<p>That data spans Q1 of 2015 to Q4 of 2024. The average net sales over the period under review was $2.16 billion. This is lower than the all time maximum net sales of $3.25 billion which was recorded in Q1 of 2024. This supports the assertion of an upward trend in Net Sales over the period. The script below produces Table 3.1 which displays summary statistics for net sales (in Millions).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp3)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/lwhite01/Data/main/HersheyData.csv"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FullDate =</span> <span class="fu">paste</span>(Year, Quarter, <span class="at">sep=</span><span class="st">'Q'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, FullDate, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(FullDate) <span class="ot">-&gt;</span> data</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">###Descriptive Stats of Chosen Variables</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>des_NS <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">Mean =</span> <span class="fu">mean</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span>),</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">Median =</span> <span class="fu">median</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span>),</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">Min =</span> <span class="fu">min</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span>),</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">Max =</span> <span class="fu">max</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span>),</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>() <span class="sc">%&gt;%</span> <span class="fu">tab_header</span>(</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**Summary Statistics**"</span>),</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">subtitle =</span> <span class="st">"Summary Statistics for Net Sales (in Millions)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>     <span class="fu">fmt_number</span>(</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">columns =</span> <span class="fu">everything</span>(),</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">decimals =</span> <span class="dv">0</span>,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">use_seps =</span> <span class="cn">TRUE</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>     ) <span class="sc">%&gt;%</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_options</span>(<span class="at">table.width =</span> <span class="fu">px</span>(<span class="dv">600</span>))</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>des_NS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="lfcillwjxc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lfcillwjxc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lfcillwjxc thead, #lfcillwjxc tbody, #lfcillwjxc tfoot, #lfcillwjxc tr, #lfcillwjxc td, #lfcillwjxc th {
  border-style: none;
}

#lfcillwjxc p {
  margin: 0;
  padding: 0;
}

#lfcillwjxc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lfcillwjxc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lfcillwjxc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lfcillwjxc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lfcillwjxc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lfcillwjxc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lfcillwjxc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lfcillwjxc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lfcillwjxc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lfcillwjxc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lfcillwjxc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lfcillwjxc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lfcillwjxc .gt_spanner_row {
  border-bottom-style: hidden;
}

#lfcillwjxc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lfcillwjxc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lfcillwjxc .gt_from_md > :first-child {
  margin-top: 0;
}

#lfcillwjxc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lfcillwjxc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lfcillwjxc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lfcillwjxc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lfcillwjxc .gt_row_group_first td {
  border-top-width: 2px;
}

#lfcillwjxc .gt_row_group_first th {
  border-top-width: 2px;
}

#lfcillwjxc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lfcillwjxc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lfcillwjxc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lfcillwjxc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lfcillwjxc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lfcillwjxc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lfcillwjxc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lfcillwjxc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lfcillwjxc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lfcillwjxc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lfcillwjxc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lfcillwjxc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lfcillwjxc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lfcillwjxc .gt_left {
  text-align: left;
}

#lfcillwjxc .gt_center {
  text-align: center;
}

#lfcillwjxc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lfcillwjxc .gt_font_normal {
  font-weight: normal;
}

#lfcillwjxc .gt_font_bold {
  font-weight: bold;
}

#lfcillwjxc .gt_font_italic {
  font-style: italic;
}

#lfcillwjxc .gt_super {
  font-size: 65%;
}

#lfcillwjxc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lfcillwjxc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lfcillwjxc .gt_indent_1 {
  text-indent: 5px;
}

#lfcillwjxc .gt_indent_2 {
  text-indent: 10px;
}

#lfcillwjxc .gt_indent_3 {
  text-indent: 15px;
}

#lfcillwjxc .gt_indent_4 {
  text-indent: 20px;
}

#lfcillwjxc .gt_indent_5 {
  text-indent: 25px;
}

#lfcillwjxc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lfcillwjxc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="4" class="gt_heading gt_title gt_font_normal"><p><strong>Summary Statistics</strong></p></th>
</tr>
<tr class="odd gt_heading">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Summary Statistics for Net Sales (in Millions)</th>
</tr>
<tr class="header gt_col_headings">
<th id="Mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Mean</th>
<th id="Median" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Median</th>
<th id="Min" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Min</th>
<th id="Max" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Max</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="Mean">2,164</td>
<td class="gt_row gt_right" headers="Median">2,033</td>
<td class="gt_row gt_right" headers="Min">1,579</td>
<td class="gt_row gt_right" headers="Max">3,253</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><br> Similarly, Hersheys recorded an average cost of saless of $1.19 billion over the review period. In the last two quarters of the review period, it was more efficient by recording a cost of sales of $1.53 billion in Q4 2023 and $1.58 billion in Q1 2024 compared to a period maximum of $1.67 billion in Q3 2023. The script and Table 3.2 below show summary statistics for cost of sales (in Millions)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>des_COS <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">Mean =</span> <span class="fu">mean</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span>),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">Median =</span> <span class="fu">median</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">Min =</span> <span class="fu">min</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">Max =</span> <span class="fu">max</span>(data<span class="sc">$</span><span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>)<span class="sc">%&gt;%</span> <span class="fu">gt</span>() <span class="sc">%&gt;%</span> <span class="fu">tab_header</span>(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**Summary Statistics**"</span>),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">subtitle =</span> <span class="st">"Summary Statistics for Cost of Sales (In Millions)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">fmt_number</span>(</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">columns =</span> <span class="fu">everything</span>(),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">decimals =</span> <span class="dv">0</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">use_seps =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">tab_options</span>(<span class="at">table.width =</span> <span class="fu">px</span>(<span class="dv">600</span>))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>des_COS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="smprhzpdcz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#smprhzpdcz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#smprhzpdcz thead, #smprhzpdcz tbody, #smprhzpdcz tfoot, #smprhzpdcz tr, #smprhzpdcz td, #smprhzpdcz th {
  border-style: none;
}

#smprhzpdcz p {
  margin: 0;
  padding: 0;
}

#smprhzpdcz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#smprhzpdcz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#smprhzpdcz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#smprhzpdcz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#smprhzpdcz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#smprhzpdcz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#smprhzpdcz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#smprhzpdcz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#smprhzpdcz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#smprhzpdcz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#smprhzpdcz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#smprhzpdcz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#smprhzpdcz .gt_spanner_row {
  border-bottom-style: hidden;
}

#smprhzpdcz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#smprhzpdcz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#smprhzpdcz .gt_from_md > :first-child {
  margin-top: 0;
}

#smprhzpdcz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#smprhzpdcz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#smprhzpdcz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#smprhzpdcz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#smprhzpdcz .gt_row_group_first td {
  border-top-width: 2px;
}

#smprhzpdcz .gt_row_group_first th {
  border-top-width: 2px;
}

#smprhzpdcz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#smprhzpdcz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#smprhzpdcz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#smprhzpdcz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#smprhzpdcz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#smprhzpdcz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#smprhzpdcz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#smprhzpdcz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#smprhzpdcz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#smprhzpdcz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#smprhzpdcz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#smprhzpdcz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#smprhzpdcz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#smprhzpdcz .gt_left {
  text-align: left;
}

#smprhzpdcz .gt_center {
  text-align: center;
}

#smprhzpdcz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#smprhzpdcz .gt_font_normal {
  font-weight: normal;
}

#smprhzpdcz .gt_font_bold {
  font-weight: bold;
}

#smprhzpdcz .gt_font_italic {
  font-style: italic;
}

#smprhzpdcz .gt_super {
  font-size: 65%;
}

#smprhzpdcz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#smprhzpdcz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#smprhzpdcz .gt_indent_1 {
  text-indent: 5px;
}

#smprhzpdcz .gt_indent_2 {
  text-indent: 10px;
}

#smprhzpdcz .gt_indent_3 {
  text-indent: 15px;
}

#smprhzpdcz .gt_indent_4 {
  text-indent: 20px;
}

#smprhzpdcz .gt_indent_5 {
  text-indent: 25px;
}

#smprhzpdcz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#smprhzpdcz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="4" class="gt_heading gt_title gt_font_normal"><p><strong>Summary Statistics</strong></p></th>
</tr>
<tr class="odd gt_heading">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Summary Statistics for Cost of Sales (In Millions)</th>
</tr>
<tr class="header gt_col_headings">
<th id="Mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Mean</th>
<th id="Median" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Median</th>
<th id="Min" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Min</th>
<th id="Max" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Max</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="Mean">1,188</td>
<td class="gt_row gt_right" headers="Median">1,153</td>
<td class="gt_row gt_right" headers="Min">843</td>
<td class="gt_row gt_right" headers="Max">1,670</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><br> As a result of the high Net Sales of $3.25 billion compared to the cost of sales of $1.58 billion in Q1 2024, it recorded an all time income before tax of $1.68 billion.</p>
<p><br></p>
<section id="time-series-visualization" class="level3">
<h3 class="anchored" data-anchor-id="time-series-visualization">Time Series Visualization:</h3>
<p>The script below produces a visual of the distribution of Net Sales, Cost of Sales and income before tax over the review period.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> FullDate)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">"Net Sales"</span>, <span class="at">group =</span> <span class="dv">1</span>), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">"Cost of Sales"</span>, <span class="at">group =</span> <span class="dv">1</span>), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Income before Income Taxes</span><span class="st">`</span>, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"Income Before Taxes"</span>, <span class="at">group =</span> <span class="dv">1</span>), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Net Sales, Cost of Sales, and Income Before Taxes Over Time"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Time (Year and Quarter)"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Amount (in Millions)"</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Legend"</span>) <span class="ot">-&gt;</span> fullPlot</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>Q1pos <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">'Q1'</span>,data<span class="sc">$</span>FullDate)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>fullPlot <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> Q1pos, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hershey_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It is evident from the chart above there is an upward trend for all the variables. Seasonality is also evident. Note that black vertical broken lines represent Q1 of each review year. To investigate seasonality and trend further, it is important to consider a decomposition of these elements. These are produced by the scripts below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make time series tsibble</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FullDate=</span><span class="fu">yearquarter</span>(FullDate)) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index=</span>FullDate) <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">factor</span>(<span class="fu">quarter</span>(FullDate)))<span class="ot">-&gt;</span>data_ts</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="do">#### NET SALES Decomposition</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>data_ts <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">STL=</span><span class="fu">STL</span>(<span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span><span class="sc">~</span><span class="fu">trend</span>()<span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">season</span>(), <span class="at">robust=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()<span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hershey_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### COST OF SALES Decomposition</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>data_ts <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">STL=</span><span class="fu">STL</span>(<span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span><span class="sc">~</span><span class="fu">trend</span>()<span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">season</span>(), <span class="at">robust=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()<span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hershey_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The charts above confirm the presence of trend and seasonality in the data set. This means it is appropriate to run a time series forecast to predict future net sales and cost of sales. <br></p>
</section>
</section>
<section id="forecasting" class="level2">
<h2 class="anchored" data-anchor-id="forecasting">4. Forecasting</h2>
<section id="forecasting-methodology" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-methodology">Forecasting Methodology</h3>
<p>With the establishment of the data as a suitable time series, the next step would be to select a suitable forecast model. Model Selection: In this project, we used several forecasting models including TSLM (Time Series Linear Model), ETS (Error, Trend, Seasonality), and ARIMA (AutoRegressive Integrated Moving Average) to predict future values of both Net Sales and Cost of Sales. Each model was selected based on its strengths.</p>
<ul>
<li><p>TSLM was chosen for its ability to model trend and seasonality explicitly, allowing us to incorporate linear relationships over time, including polynomial trends.</p></li>
<li><p>ETS was used to capture the inherent patterns in the data by decomposing it into error, trend, and seasonality components. This method is highly effective when the data exhibits clear seasonal cycles.</p></li>
<li><p>ARIMA was selected for its flexibility in handling non-stationary data and its ability to model autocorrelations.</p></li>
</ul>
</section>
<section id="model-selection" class="level3">
<h3 class="anchored" data-anchor-id="model-selection">Model Selection</h3>
<p>A combination approach (Combo Model) was employed in all instances to improve forecasting accuracy, with weights assigned to different models. In the model selection for Net Sales, a weight of 0.2 for ARIMA and 0.8 for TSLM were applied to balance their strengths. On the other hand, a weight of 0.1 for ETS and 0.9 for TSLM2 was applied to determine a Combo model for Cost of Sales.</p>
<p>The model performance was evaluated using the Winkler Score, a metric used to assess the accuracy of probabilistic forecasts, and various accuracy metrics to select the best-performing models for future predictions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data_ts <span class="sc">%&gt;%</span> <span class="fu">filter_index</span>(.<span class="sc">~</span><span class="st">"2022 Q2"</span>) <span class="ot">-&gt;</span> train</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>data_ts <span class="sc">%&gt;%</span> <span class="fu">filter_index</span>(<span class="st">"2022 Q3"</span><span class="sc">~</span><span class="st">"2024 Q1"</span>) <span class="ot">-&gt;</span> test</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="do">###TRAINING THE MODEL TO PREDICT NET SALES &amp; VERIFYING ACCURACY</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>train <span class="sc">%&gt;%</span> <span class="fu">model</span>(<span class="at">TSLM=</span><span class="fu">TSLM</span>(<span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span><span class="sc">~</span><span class="fu">trend</span>()<span class="sc">+</span><span class="fu">season</span>()),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">TSLM2=</span><span class="fu">TSLM</span>(<span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span><span class="sc">~</span><span class="fu">trend</span>()<span class="sc">+</span> <span class="fu">I</span>(<span class="fu">trend</span>()<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">season</span>()),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">ETS=</span><span class="fu">ETS</span>(<span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">ARIMA=</span><span class="fu">ARIMA</span>(<span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span>)) <span class="ot">-&gt;</span> fit</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy of Models</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(test) <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(data_ts, <span class="fu">list</span>(<span class="at">winkler =</span> winkler_score)) <span class="sc">%&gt;%</span> <span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**Winkler Score**"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> winkler,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_seps =</span> <span class="cn">TRUE</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">table.width =</span> <span class="fu">px</span>(<span class="dv">600</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="xzusrotkqk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xzusrotkqk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xzusrotkqk thead, #xzusrotkqk tbody, #xzusrotkqk tfoot, #xzusrotkqk tr, #xzusrotkqk td, #xzusrotkqk th {
  border-style: none;
}

#xzusrotkqk p {
  margin: 0;
  padding: 0;
}

#xzusrotkqk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xzusrotkqk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xzusrotkqk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xzusrotkqk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xzusrotkqk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xzusrotkqk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xzusrotkqk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xzusrotkqk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xzusrotkqk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xzusrotkqk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xzusrotkqk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xzusrotkqk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xzusrotkqk .gt_spanner_row {
  border-bottom-style: hidden;
}

#xzusrotkqk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xzusrotkqk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xzusrotkqk .gt_from_md > :first-child {
  margin-top: 0;
}

#xzusrotkqk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xzusrotkqk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xzusrotkqk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xzusrotkqk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xzusrotkqk .gt_row_group_first td {
  border-top-width: 2px;
}

#xzusrotkqk .gt_row_group_first th {
  border-top-width: 2px;
}

#xzusrotkqk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xzusrotkqk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xzusrotkqk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xzusrotkqk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xzusrotkqk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xzusrotkqk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xzusrotkqk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xzusrotkqk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xzusrotkqk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xzusrotkqk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xzusrotkqk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xzusrotkqk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xzusrotkqk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xzusrotkqk .gt_left {
  text-align: left;
}

#xzusrotkqk .gt_center {
  text-align: center;
}

#xzusrotkqk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xzusrotkqk .gt_font_normal {
  font-weight: normal;
}

#xzusrotkqk .gt_font_bold {
  font-weight: bold;
}

#xzusrotkqk .gt_font_italic {
  font-style: italic;
}

#xzusrotkqk .gt_super {
  font-size: 65%;
}

#xzusrotkqk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xzusrotkqk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xzusrotkqk .gt_indent_1 {
  text-indent: 5px;
}

#xzusrotkqk .gt_indent_2 {
  text-indent: 10px;
}

#xzusrotkqk .gt_indent_3 {
  text-indent: 15px;
}

#xzusrotkqk .gt_indent_4 {
  text-indent: 20px;
}

#xzusrotkqk .gt_indent_5 {
  text-indent: 25px;
}

#xzusrotkqk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xzusrotkqk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border"><p><strong>Winkler Score</strong></p></th>
</tr>
<tr class="odd gt_col_headings">
<th id=".model" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.model</th>
<th id=".type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.type</th>
<th id="winkler" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">winkler</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_left" headers=".type">Test</td>
<td class="gt_row gt_right" headers="winkler">778.60</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_left" headers=".type">Test</td>
<td class="gt_row gt_right" headers="winkler">910.60</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">TSLM</td>
<td class="gt_row gt_left" headers=".type">Test</td>
<td class="gt_row gt_right" headers="winkler">6,855.94</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_left" headers=".type">Test</td>
<td class="gt_row gt_right" headers="winkler">1,037.55</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data_ts <span class="sc">%&gt;%</span> <span class="fu">stretch_tsibble</span>(<span class="at">.init =</span> <span class="dv">20</span>, <span class="at">.step=</span><span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">TSLM=</span><span class="fu">TSLM</span>(<span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span><span class="sc">~</span><span class="fu">trend</span>()<span class="sc">+</span><span class="fu">season</span>()),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">TSLM2=</span><span class="fu">TSLM</span>(<span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span><span class="sc">~</span><span class="fu">trend</span>()<span class="sc">+</span> <span class="fu">I</span>(<span class="fu">trend</span>()<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">season</span>()),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">ARIMA=</span><span class="fu">ARIMA</span>(<span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">ETS=</span><span class="fu">ETS</span>(<span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Combo=</span><span class="fl">0.2</span><span class="sc">*</span>ARIMA<span class="fl">+0.8</span><span class="sc">*</span>TSLM2) <span class="sc">%&gt;%</span>                 </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(data_ts) <span class="sc">%&gt;%</span> <span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**Net Sales Model Accuracy**"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>(),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_seps =</span> <span class="cn">TRUE</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">tab_style</span>(</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(<span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"lightblue"</span>)),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">rows =</span> .model <span class="sc">==</span> <span class="st">"Combo"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="nnaqvggkjd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nnaqvggkjd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nnaqvggkjd thead, #nnaqvggkjd tbody, #nnaqvggkjd tfoot, #nnaqvggkjd tr, #nnaqvggkjd td, #nnaqvggkjd th {
  border-style: none;
}

#nnaqvggkjd p {
  margin: 0;
  padding: 0;
}

#nnaqvggkjd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nnaqvggkjd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nnaqvggkjd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nnaqvggkjd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nnaqvggkjd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nnaqvggkjd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nnaqvggkjd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nnaqvggkjd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nnaqvggkjd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nnaqvggkjd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nnaqvggkjd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nnaqvggkjd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nnaqvggkjd .gt_spanner_row {
  border-bottom-style: hidden;
}

#nnaqvggkjd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nnaqvggkjd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nnaqvggkjd .gt_from_md > :first-child {
  margin-top: 0;
}

#nnaqvggkjd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nnaqvggkjd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nnaqvggkjd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nnaqvggkjd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nnaqvggkjd .gt_row_group_first td {
  border-top-width: 2px;
}

#nnaqvggkjd .gt_row_group_first th {
  border-top-width: 2px;
}

#nnaqvggkjd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nnaqvggkjd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nnaqvggkjd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nnaqvggkjd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nnaqvggkjd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nnaqvggkjd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nnaqvggkjd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nnaqvggkjd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nnaqvggkjd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nnaqvggkjd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nnaqvggkjd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nnaqvggkjd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nnaqvggkjd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nnaqvggkjd .gt_left {
  text-align: left;
}

#nnaqvggkjd .gt_center {
  text-align: center;
}

#nnaqvggkjd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nnaqvggkjd .gt_font_normal {
  font-weight: normal;
}

#nnaqvggkjd .gt_font_bold {
  font-weight: bold;
}

#nnaqvggkjd .gt_font_italic {
  font-style: italic;
}

#nnaqvggkjd .gt_super {
  font-size: 65%;
}

#nnaqvggkjd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nnaqvggkjd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nnaqvggkjd .gt_indent_1 {
  text-indent: 5px;
}

#nnaqvggkjd .gt_indent_2 {
  text-indent: 10px;
}

#nnaqvggkjd .gt_indent_3 {
  text-indent: 15px;
}

#nnaqvggkjd .gt_indent_4 {
  text-indent: 20px;
}

#nnaqvggkjd .gt_indent_5 {
  text-indent: 25px;
}

#nnaqvggkjd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nnaqvggkjd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="10" class="gt_heading gt_title gt_font_normal gt_bottom_border"><p><strong>Net Sales Model Accuracy</strong></p></th>
</tr>
<tr class="odd gt_col_headings">
<th id=".model" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.model</th>
<th id=".type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.type</th>
<th id="ME" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">ME</th>
<th id="RMSE" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">RMSE</th>
<th id="MAE" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">MAE</th>
<th id="MPE" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">MPE</th>
<th id="MAPE" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">MAPE</th>
<th id="MASE" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">MASE</th>
<th id="RMSSE" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">RMSSE</th>
<th id="ACF1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">ACF1</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_left" headers=".type">Test</td>
<td class="gt_row gt_right" headers="ME">180.04</td>
<td class="gt_row gt_right" headers="RMSE">255.56</td>
<td class="gt_row gt_right" headers="MAE">206.74</td>
<td class="gt_row gt_right" headers="MPE">6.81</td>
<td class="gt_row gt_right" headers="MAPE">8.08</td>
<td class="gt_row gt_right" headers="MASE">1.60</td>
<td class="gt_row gt_right" headers="RMSSE">1.47</td>
<td class="gt_row gt_right" headers="ACF1">0.57</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model" style="background-color: #ADD8E6">Combo</td>
<td class="gt_row gt_left" headers=".type" style="background-color: #ADD8E6">Test</td>
<td class="gt_row gt_right" headers="ME" style="background-color: #ADD8E6">119.43</td>
<td class="gt_row gt_right" headers="RMSE" style="background-color: #ADD8E6">217.91</td>
<td class="gt_row gt_right" headers="MAE" style="background-color: #ADD8E6">171.50</td>
<td class="gt_row gt_right" headers="MPE" style="background-color: #ADD8E6">4.37</td>
<td class="gt_row gt_right" headers="MAPE" style="background-color: #ADD8E6">6.69</td>
<td class="gt_row gt_right" headers="MASE" style="background-color: #ADD8E6">1.33</td>
<td class="gt_row gt_right" headers="RMSSE" style="background-color: #ADD8E6">1.25</td>
<td class="gt_row gt_right" headers="ACF1" style="background-color: #ADD8E6">0.41</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_left" headers=".type">Test</td>
<td class="gt_row gt_right" headers="ME">191.76</td>
<td class="gt_row gt_right" headers="RMSE">327.92</td>
<td class="gt_row gt_right" headers="MAE">261.68</td>
<td class="gt_row gt_right" headers="MPE">7.54</td>
<td class="gt_row gt_right" headers="MAPE">10.31</td>
<td class="gt_row gt_right" headers="MASE">2.03</td>
<td class="gt_row gt_right" headers="RMSSE">1.88</td>
<td class="gt_row gt_right" headers="ACF1">0.51</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">TSLM</td>
<td class="gt_row gt_left" headers=".type">Test</td>
<td class="gt_row gt_right" headers="ME">264.26</td>
<td class="gt_row gt_right" headers="RMSE">340.29</td>
<td class="gt_row gt_right" headers="MAE">275.38</td>
<td class="gt_row gt_right" headers="MPE">9.85</td>
<td class="gt_row gt_right" headers="MAPE">10.49</td>
<td class="gt_row gt_right" headers="MASE">2.13</td>
<td class="gt_row gt_right" headers="RMSSE">1.95</td>
<td class="gt_row gt_right" headers="ACF1">0.48</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_left" headers=".type">Test</td>
<td class="gt_row gt_right" headers="ME">104.27</td>
<td class="gt_row gt_right" headers="RMSE">212.07</td>
<td class="gt_row gt_right" headers="MAE">162.69</td>
<td class="gt_row gt_right" headers="MPE">3.76</td>
<td class="gt_row gt_right" headers="MAPE">6.34</td>
<td class="gt_row gt_right" headers="MASE">1.26</td>
<td class="gt_row gt_right" headers="RMSSE">1.22</td>
<td class="gt_row gt_right" headers="ACF1">0.37</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">###TRAINING THE MODEL TO PREDICT COST OF SALES &amp; VERIFYING ACCURACY</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>train <span class="sc">%&gt;%</span> <span class="fu">model</span>(<span class="at">TSLM=</span><span class="fu">TSLM</span>(<span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span><span class="sc">~</span><span class="fu">trend</span>()<span class="sc">+</span><span class="fu">season</span>()),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">TSLM2=</span><span class="fu">TSLM</span>(<span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span><span class="sc">~</span><span class="fu">trend</span>()<span class="sc">+</span> <span class="fu">I</span>(<span class="fu">trend</span>()<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">season</span>()),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">ETS=</span><span class="fu">ETS</span>(<span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">ARIMA=</span><span class="fu">ARIMA</span>(<span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span>)) <span class="ot">-&gt;</span> fitC</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy of Models</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>fitC <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(test) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(data_ts, <span class="fu">list</span>(<span class="at">winkler =</span> winkler_score)) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**Winkler Score**"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> winkler,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_seps =</span> <span class="cn">TRUE</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">table.width =</span> <span class="fu">px</span>(<span class="dv">600</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="cxifxgowsd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cxifxgowsd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cxifxgowsd thead, #cxifxgowsd tbody, #cxifxgowsd tfoot, #cxifxgowsd tr, #cxifxgowsd td, #cxifxgowsd th {
  border-style: none;
}

#cxifxgowsd p {
  margin: 0;
  padding: 0;
}

#cxifxgowsd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cxifxgowsd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cxifxgowsd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cxifxgowsd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cxifxgowsd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cxifxgowsd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cxifxgowsd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cxifxgowsd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cxifxgowsd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cxifxgowsd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cxifxgowsd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cxifxgowsd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cxifxgowsd .gt_spanner_row {
  border-bottom-style: hidden;
}

#cxifxgowsd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cxifxgowsd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cxifxgowsd .gt_from_md > :first-child {
  margin-top: 0;
}

#cxifxgowsd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cxifxgowsd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cxifxgowsd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cxifxgowsd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cxifxgowsd .gt_row_group_first td {
  border-top-width: 2px;
}

#cxifxgowsd .gt_row_group_first th {
  border-top-width: 2px;
}

#cxifxgowsd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxifxgowsd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cxifxgowsd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cxifxgowsd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cxifxgowsd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxifxgowsd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cxifxgowsd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cxifxgowsd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cxifxgowsd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cxifxgowsd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cxifxgowsd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxifxgowsd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cxifxgowsd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxifxgowsd .gt_left {
  text-align: left;
}

#cxifxgowsd .gt_center {
  text-align: center;
}

#cxifxgowsd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cxifxgowsd .gt_font_normal {
  font-weight: normal;
}

#cxifxgowsd .gt_font_bold {
  font-weight: bold;
}

#cxifxgowsd .gt_font_italic {
  font-style: italic;
}

#cxifxgowsd .gt_super {
  font-size: 65%;
}

#cxifxgowsd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cxifxgowsd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cxifxgowsd .gt_indent_1 {
  text-indent: 5px;
}

#cxifxgowsd .gt_indent_2 {
  text-indent: 10px;
}

#cxifxgowsd .gt_indent_3 {
  text-indent: 15px;
}

#cxifxgowsd .gt_indent_4 {
  text-indent: 20px;
}

#cxifxgowsd .gt_indent_5 {
  text-indent: 25px;
}

#cxifxgowsd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cxifxgowsd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border"><p><strong>Winkler Score</strong></p></th>
</tr>
<tr class="odd gt_col_headings">
<th id=".model" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.model</th>
<th id=".type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.type</th>
<th id="winkler" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">winkler</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_left" headers=".type">Test</td>
<td class="gt_row gt_right" headers="winkler">869.24</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_left" headers=".type">Test</td>
<td class="gt_row gt_right" headers="winkler">684.06</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">TSLM</td>
<td class="gt_row gt_left" headers=".type">Test</td>
<td class="gt_row gt_right" headers="winkler">1,866.93</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_left" headers=".type">Test</td>
<td class="gt_row gt_right" headers="winkler">386.55</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data_ts <span class="sc">%&gt;%</span> <span class="fu">stretch_tsibble</span>(<span class="at">.init =</span> <span class="dv">20</span>, <span class="at">.step=</span><span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">TSLM=</span><span class="fu">TSLM</span>(<span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span><span class="sc">~</span><span class="fu">trend</span>()<span class="sc">+</span><span class="fu">season</span>()),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">TSLM2=</span><span class="fu">TSLM</span>(<span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span><span class="sc">~</span><span class="fu">trend</span>()<span class="sc">+</span> <span class="fu">I</span>(<span class="fu">trend</span>()<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">season</span>()),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">ARIMA=</span><span class="fu">ARIMA</span>(<span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">ETS=</span><span class="fu">ETS</span>(<span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Combo=</span><span class="fl">0.1</span><span class="sc">*</span>ETS<span class="fl">+0.9</span><span class="sc">*</span>TSLM2) <span class="sc">%&gt;%</span>                 </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>(data_ts) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**Cost of Sales Model Accuracy**"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>(),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_seps =</span> <span class="cn">TRUE</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">tab_style</span>(</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(<span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"lightblue"</span>)),</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">rows =</span> .model <span class="sc">==</span> <span class="st">"TSLM2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="zudfyzpkng" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zudfyzpkng table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zudfyzpkng thead, #zudfyzpkng tbody, #zudfyzpkng tfoot, #zudfyzpkng tr, #zudfyzpkng td, #zudfyzpkng th {
  border-style: none;
}

#zudfyzpkng p {
  margin: 0;
  padding: 0;
}

#zudfyzpkng .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zudfyzpkng .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zudfyzpkng .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zudfyzpkng .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zudfyzpkng .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zudfyzpkng .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zudfyzpkng .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zudfyzpkng .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zudfyzpkng .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zudfyzpkng .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zudfyzpkng .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zudfyzpkng .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zudfyzpkng .gt_spanner_row {
  border-bottom-style: hidden;
}

#zudfyzpkng .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zudfyzpkng .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zudfyzpkng .gt_from_md > :first-child {
  margin-top: 0;
}

#zudfyzpkng .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zudfyzpkng .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zudfyzpkng .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zudfyzpkng .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zudfyzpkng .gt_row_group_first td {
  border-top-width: 2px;
}

#zudfyzpkng .gt_row_group_first th {
  border-top-width: 2px;
}

#zudfyzpkng .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zudfyzpkng .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zudfyzpkng .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zudfyzpkng .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zudfyzpkng .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zudfyzpkng .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zudfyzpkng .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zudfyzpkng .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zudfyzpkng .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zudfyzpkng .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zudfyzpkng .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zudfyzpkng .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zudfyzpkng .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zudfyzpkng .gt_left {
  text-align: left;
}

#zudfyzpkng .gt_center {
  text-align: center;
}

#zudfyzpkng .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zudfyzpkng .gt_font_normal {
  font-weight: normal;
}

#zudfyzpkng .gt_font_bold {
  font-weight: bold;
}

#zudfyzpkng .gt_font_italic {
  font-style: italic;
}

#zudfyzpkng .gt_super {
  font-size: 65%;
}

#zudfyzpkng .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zudfyzpkng .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zudfyzpkng .gt_indent_1 {
  text-indent: 5px;
}

#zudfyzpkng .gt_indent_2 {
  text-indent: 10px;
}

#zudfyzpkng .gt_indent_3 {
  text-indent: 15px;
}

#zudfyzpkng .gt_indent_4 {
  text-indent: 20px;
}

#zudfyzpkng .gt_indent_5 {
  text-indent: 25px;
}

#zudfyzpkng .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zudfyzpkng div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="10" class="gt_heading gt_title gt_font_normal gt_bottom_border"><p><strong>Cost of Sales Model Accuracy</strong></p></th>
</tr>
<tr class="odd gt_col_headings">
<th id=".model" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.model</th>
<th id=".type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.type</th>
<th id="ME" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">ME</th>
<th id="RMSE" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">RMSE</th>
<th id="MAE" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">MAE</th>
<th id="MPE" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">MPE</th>
<th id="MAPE" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">MAPE</th>
<th id="MASE" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">MASE</th>
<th id="RMSSE" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">RMSSE</th>
<th id="ACF1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">ACF1</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_left" headers=".type">Test</td>
<td class="gt_row gt_right" headers="ME">111.66</td>
<td class="gt_row gt_right" headers="RMSE">163.22</td>
<td class="gt_row gt_right" headers="MAE">139.17</td>
<td class="gt_row gt_right" headers="MPE">8.10</td>
<td class="gt_row gt_right" headers="MAPE">10.11</td>
<td class="gt_row gt_right" headers="MASE">1.37</td>
<td class="gt_row gt_right" headers="RMSSE">1.27</td>
<td class="gt_row gt_right" headers="ACF1">0.61</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">Combo</td>
<td class="gt_row gt_left" headers=".type">Test</td>
<td class="gt_row gt_right" headers="ME">89.82</td>
<td class="gt_row gt_right" headers="RMSE">158.78</td>
<td class="gt_row gt_right" headers="MAE">133.85</td>
<td class="gt_row gt_right" headers="MPE">6.45</td>
<td class="gt_row gt_right" headers="MAPE">9.60</td>
<td class="gt_row gt_right" headers="MASE">1.32</td>
<td class="gt_row gt_right" headers="RMSSE">1.23</td>
<td class="gt_row gt_right" headers="ACF1">0.62</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_left" headers=".type">Test</td>
<td class="gt_row gt_right" headers="ME">169.64</td>
<td class="gt_row gt_right" headers="RMSE">212.63</td>
<td class="gt_row gt_right" headers="MAE">173.82</td>
<td class="gt_row gt_right" headers="MPE">12.27</td>
<td class="gt_row gt_right" headers="MAPE">12.55</td>
<td class="gt_row gt_right" headers="MASE">1.71</td>
<td class="gt_row gt_right" headers="RMSSE">1.65</td>
<td class="gt_row gt_right" headers="ACF1">0.62</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">TSLM</td>
<td class="gt_row gt_left" headers=".type">Test</td>
<td class="gt_row gt_right" headers="ME">153.93</td>
<td class="gt_row gt_right" headers="RMSE">199.11</td>
<td class="gt_row gt_right" headers="MAE">164.57</td>
<td class="gt_row gt_right" headers="MPE">10.63</td>
<td class="gt_row gt_right" headers="MAPE">11.65</td>
<td class="gt_row gt_right" headers="MASE">1.62</td>
<td class="gt_row gt_right" headers="RMSSE">1.54</td>
<td class="gt_row gt_right" headers="ACF1">0.73</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model" style="background-color: #ADD8E6">TSLM2</td>
<td class="gt_row gt_left" headers=".type" style="background-color: #ADD8E6">Test</td>
<td class="gt_row gt_right" headers="ME" style="background-color: #ADD8E6">80.95</td>
<td class="gt_row gt_right" headers="RMSE" style="background-color: #ADD8E6">154.60</td>
<td class="gt_row gt_right" headers="MAE" style="background-color: #ADD8E6">131.19</td>
<td class="gt_row gt_right" headers="MPE" style="background-color: #ADD8E6">5.80</td>
<td class="gt_row gt_right" headers="MAPE" style="background-color: #ADD8E6">9.39</td>
<td class="gt_row gt_right" headers="MASE" style="background-color: #ADD8E6">1.29</td>
<td class="gt_row gt_right" headers="RMSSE" style="background-color: #ADD8E6">1.20</td>
<td class="gt_row gt_right" headers="ACF1" style="background-color: #ADD8E6">0.62</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>For validation, cross-validation was used with rolling windows to evaluate model performance across different sections of the data. The accuracy of each model was assessed, and TSLM2 and Combo models were chosen as the most accurate for forecasting.</p>
<p>Finally, forecasts were generated for seven quarters, and prediction intervals were calculated to account for uncertainty. Visualizations were created to compare actual data with the model forecasts, providing a clear assessment of each model’s performance. <br></p>
</section>
<section id="variable-1-net-sales-forecasting" class="level3">
<h3 class="anchored" data-anchor-id="variable-1-net-sales-forecasting">Variable 1: Net Sales Forecasting</h3>
<p>Using models deemed best based on the winkler score, accuracy, and overall fit, forecasts for the next 7 quarters were created and visualized.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data_ts <span class="sc">%&gt;%</span> <span class="fu">model</span>(<span class="at">TSLM2=</span><span class="fu">TSLM</span>(<span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span><span class="sc">~</span><span class="fu">trend</span>()<span class="sc">+</span> <span class="fu">I</span>(<span class="fu">trend</span>()<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">season</span>()),</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ARIMA=</span><span class="fu">ARIMA</span>(<span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span>),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ETS=</span><span class="fu">ETS</span>(<span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Combo=</span><span class="fl">0.2</span><span class="sc">*</span>ARIMA<span class="fl">+0.8</span><span class="sc">*</span>TSLM2) <span class="ot">-&gt;</span> fit2</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>fit2 <span class="sc">%&gt;%</span> <span class="fu">augment</span>() <span class="ot">-&gt;</span> resids2</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>resids2 <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(.resid) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hershey_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Combo Model - best here</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>data_ts <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(resids2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(.model<span class="sc">==</span><span class="st">"Combo"</span>),.fitted, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Combo Model vs Actual Data'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hershey_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot TSLM2 Model</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>data_ts <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(resids2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(.model<span class="sc">==</span><span class="st">"TSLM2"</span>),.fitted, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'TSLM2 Model vs Actual Data'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hershey_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ARIMA Model</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>data_ts <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(resids2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(.model<span class="sc">==</span><span class="st">"ARIMA"</span>),.fitted, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'ARIMA Model vs Actual Data'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hershey_files/figure-html/unnamed-chunk-6-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">7</span>) <span class="sc">%&gt;%</span> <span class="fu">hilo</span>(<span class="at">level=</span><span class="dv">95</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="whznnsyqrs" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#whznnsyqrs table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#whznnsyqrs thead, #whznnsyqrs tbody, #whznnsyqrs tfoot, #whznnsyqrs tr, #whznnsyqrs td, #whznnsyqrs th {
  border-style: none;
}

#whznnsyqrs p {
  margin: 0;
  padding: 0;
}

#whznnsyqrs .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#whznnsyqrs .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#whznnsyqrs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#whznnsyqrs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#whznnsyqrs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#whznnsyqrs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#whznnsyqrs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#whznnsyqrs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#whznnsyqrs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#whznnsyqrs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#whznnsyqrs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#whznnsyqrs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#whznnsyqrs .gt_spanner_row {
  border-bottom-style: hidden;
}

#whznnsyqrs .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#whznnsyqrs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#whznnsyqrs .gt_from_md > :first-child {
  margin-top: 0;
}

#whznnsyqrs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#whznnsyqrs .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#whznnsyqrs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#whznnsyqrs .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#whznnsyqrs .gt_row_group_first td {
  border-top-width: 2px;
}

#whznnsyqrs .gt_row_group_first th {
  border-top-width: 2px;
}

#whznnsyqrs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#whznnsyqrs .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#whznnsyqrs .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#whznnsyqrs .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#whznnsyqrs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#whznnsyqrs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#whznnsyqrs .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#whznnsyqrs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#whznnsyqrs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#whznnsyqrs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#whznnsyqrs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#whznnsyqrs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#whznnsyqrs .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#whznnsyqrs .gt_left {
  text-align: left;
}

#whznnsyqrs .gt_center {
  text-align: center;
}

#whznnsyqrs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#whznnsyqrs .gt_font_normal {
  font-weight: normal;
}

#whznnsyqrs .gt_font_bold {
  font-weight: bold;
}

#whznnsyqrs .gt_font_italic {
  font-style: italic;
}

#whznnsyqrs .gt_super {
  font-size: 65%;
}

#whznnsyqrs .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#whznnsyqrs .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#whznnsyqrs .gt_indent_1 {
  text-indent: 5px;
}

#whznnsyqrs .gt_indent_2 {
  text-indent: 10px;
}

#whznnsyqrs .gt_indent_3 {
  text-indent: 15px;
}

#whznnsyqrs .gt_indent_4 {
  text-indent: 20px;
}

#whznnsyqrs .gt_indent_5 {
  text-indent: 25px;
}

#whznnsyqrs .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#whznnsyqrs div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id=".model" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.model</th>
<th id="FullDate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">FullDate</th>
<th id="Net Sales (in Millions)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Net Sales (in Millions)</th>
<th id=".mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">.mean</th>
<th id="95%" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95%</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q2</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(2842, 13777)</td>
<td class="gt_row gt_right" headers=".mean">2841.842</td>
<td class="gt_row gt_center" headers="95%">[2611.79150787123, 3071.89195346374]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q3</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3295, 14354)</td>
<td class="gt_row gt_right" headers=".mean">3295.384</td>
<td class="gt_row gt_center" headers="95%">[3060.56348445224, 3530.20449667579]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q4</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3255, 15016)</td>
<td class="gt_row gt_right" headers=".mean">3255.101</td>
<td class="gt_row gt_center" headers="95%">[3014.92834659677, 3495.27304321322]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q1</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3441, 15443)</td>
<td class="gt_row gt_right" headers=".mean">3440.795</td>
<td class="gt_row gt_center" headers="95%">[3197.23407952741, 3684.35675496909]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q2</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3193, 17189)</td>
<td class="gt_row gt_right" headers=".mean">3193.293</td>
<td class="gt_row gt_center" headers="95%">[2936.32967258815, 3450.25559092534]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q3</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3658, 18317)</td>
<td class="gt_row gt_right" headers=".mean">3657.739</td>
<td class="gt_row gt_center" headers="95%">[3392.47380055147, 3923.00399782482]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q4</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3628, 19568)</td>
<td class="gt_row gt_right" headers=".mean">3628.360</td>
<td class="gt_row gt_center" headers="95%">[3354.19087834528, 3902.52834378269]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q2</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(2617, 10168)</td>
<td class="gt_row gt_right" headers=".mean">2617.039</td>
<td class="gt_row gt_center" headers="95%">[2419.40126400743, 2814.67609995634]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q3</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3230, 12400)</td>
<td class="gt_row gt_right" headers=".mean">3230.283</td>
<td class="gt_row gt_center" headers="95%">[3012.02702916697, 3448.53835366484]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q4</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(2818, 18135)</td>
<td class="gt_row gt_right" headers=".mean">2818.317</td>
<td class="gt_row gt_center" headers="95%">[2554.37555604795, 3082.25856203375]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q1</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3435, 21806)</td>
<td class="gt_row gt_right" headers=".mean">3434.739</td>
<td class="gt_row gt_center" headers="95%">[3145.31214387347, 3724.16680348569]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q2</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(2788, 50527)</td>
<td class="gt_row gt_right" headers=".mean">2787.988</td>
<td class="gt_row gt_center" headers="95%">[2347.42187900105, 3228.55505513373]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q3</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3407, 62983)</td>
<td class="gt_row gt_right" headers=".mean">3407.100</td>
<td class="gt_row gt_center" headers="95%">[2915.21721885056, 3898.98201987434]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q4</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(2992, 83250)</td>
<td class="gt_row gt_right" headers=".mean">2992.016</td>
<td class="gt_row gt_center" headers="95%">[2426.50641472513, 3557.52526643061]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q2</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(2691, 15809)</td>
<td class="gt_row gt_right" headers=".mean">2690.656</td>
<td class="gt_row gt_center" headers="95%">[2444.2247347798, 2937.08703007662]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q3</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3126, 23150)</td>
<td class="gt_row gt_right" headers=".mean">3126.319</td>
<td class="gt_row gt_center" headers="95%">[2828.10820168658, 3424.52963252633]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q4</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(2885, 24678)</td>
<td class="gt_row gt_right" headers=".mean">2884.666</td>
<td class="gt_row gt_center" headers="95%">[2576.77019136388, 3192.56110619408]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q1</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3329, 38996)</td>
<td class="gt_row gt_right" headers=".mean">3328.761</td>
<td class="gt_row gt_center" headers="95%">[2941.71689216728, 3715.80464006609]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q2</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(2816, 62228)</td>
<td class="gt_row gt_right" headers=".mean">2816.331</td>
<td class="gt_row gt_center" headers="95%">[2327.40758502123, 3305.25382437758]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q3</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3252, 93300)</td>
<td class="gt_row gt_right" headers=".mean">3251.994</td>
<td class="gt_row gt_center" headers="95%">[2653.3204428271, 3850.6670359282]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q4</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3010, 113975)</td>
<td class="gt_row gt_right" headers=".mean">3010.340</td>
<td class="gt_row gt_center" headers="95%">[2348.6543826324, 3672.02655946795]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">Combo</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q2</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(2797, 11015)</td>
<td class="gt_row gt_right" headers=".mean">2796.881</td>
<td class="gt_row gt_center" headers="95%">[2591.17770991191, 3002.58453194881]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">Combo</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q3</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3282, 11702)</td>
<td class="gt_row gt_right" headers=".mean">3282.364</td>
<td class="gt_row gt_center" headers="95%">[3070.34601146646, 3494.38145000233]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">Combo</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q4</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3168, 12833)</td>
<td class="gt_row gt_right" headers=".mean">3167.744</td>
<td class="gt_row gt_center" headers="95%">[2945.71486300093, 3389.77307246341]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">Combo</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q1</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3440, 13533)</td>
<td class="gt_row gt_right" headers=".mean">3439.584</td>
<td class="gt_row gt_center" headers="95%">[3211.58203089965, 3667.58642616938]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">Combo</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q2</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3112, 17482)</td>
<td class="gt_row gt_right" headers=".mean">3112.232</td>
<td class="gt_row gt_center" headers="95%">[2853.08767401404, 3371.3759236237]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">Combo</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q3</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3608, 19383)</td>
<td class="gt_row gt_right" headers=".mean">3607.611</td>
<td class="gt_row gt_center" headers="95%">[3334.74112592587, 3880.48096052014]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">Combo</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q4</td>
<td class="gt_row gt_center" headers="Net Sales (in Millions)">N(3501, 21961)</td>
<td class="gt_row gt_right" headers=".mean">3501.091</td>
<td class="gt_row gt_center" headers="95%">[3210.63667766355, 3791.54503626997]95</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(Combo) <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">7</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">level=</span><span class="dv">95</span>) <span class="sc">+</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(data_ts, <span class="st">`</span><span class="at">Net Sales (in Millions)</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hershey's Projected Net Sales for 2024/2025"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hershey_files/figure-html/unnamed-chunk-6-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Using Combo model, we plotted the projected Net sales for the net 7 quarters.The forecast of our model shows a decrease in net sales in 2024 Q2 and 2025 Q2 and spikes in holiday-heavy quarters like Q3 &amp; Q4 2024 and Q3 &amp; Q4 2025.</p>
<ul>
<li>Q2 2024: Net Sales $2796.881 M &lt;- Low 2024</li>
<li>Q3 2024: Net Sales $3282.364 M &lt;- High 2024</li>
<li>Q4 2024: Net Sales $3167.744 M</li>
<li>Q1 2025: Net Sales $3439.584 M</li>
<li>Q2 2025: Net Sales $3112.232 M &lt;- Low 2025</li>
<li>Q3 2025: Net Sales $3607.611 M &lt;- High 2025</li>
<li>Q4 2025: Net Sales $3501.091 M</li>
</ul>
</section>
<section id="variable-2-cost-of-sales-forecasting" class="level3">
<h3 class="anchored" data-anchor-id="variable-2-cost-of-sales-forecasting">Variable 2: Cost of Sales Forecasting</h3>
<p>Similarly, visualizations of the forecast were created for variable 2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data_ts <span class="sc">%&gt;%</span> <span class="fu">model</span>(<span class="at">TSLM2=</span><span class="fu">TSLM</span>(<span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span><span class="sc">~</span><span class="fu">trend</span>()<span class="sc">+</span> <span class="fu">I</span>(<span class="fu">trend</span>()<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">season</span>()),</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ARIMA=</span><span class="fu">ARIMA</span>(<span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span>),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ETS=</span><span class="fu">ETS</span>(<span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Combo=</span><span class="fl">0.1</span><span class="sc">*</span>ETS<span class="fl">+0.9</span><span class="sc">*</span>TSLM2) <span class="ot">-&gt;</span> fitC2</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>fitC2 <span class="sc">%&gt;%</span> <span class="fu">augment</span>() <span class="ot">-&gt;</span> residsC2</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>residsC2 <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(.resid) <span class="sc">+</span> <span class="fu">theme_clean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hershey_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot TSLM2 Model - best model here</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>data_ts <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(residsC2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(.model<span class="sc">==</span><span class="st">"TSLM2"</span>),.fitted, </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'TSLM2 Model vs Actual Data'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hershey_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ETS Model</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>data_ts <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(residsC2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(.model<span class="sc">==</span><span class="st">"ETS"</span>),.fitted, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'ETS Model vs Actual Data'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hershey_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Combo Model</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>data_ts <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(residsC2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(.model<span class="sc">==</span><span class="st">"Combo"</span>),.fitted, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Combo Model vs Actual Data'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hershey_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fitC2 <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">7</span>) <span class="sc">%&gt;%</span> <span class="fu">hilo</span>(<span class="at">level=</span><span class="dv">95</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tfaxacmnvx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tfaxacmnvx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tfaxacmnvx thead, #tfaxacmnvx tbody, #tfaxacmnvx tfoot, #tfaxacmnvx tr, #tfaxacmnvx td, #tfaxacmnvx th {
  border-style: none;
}

#tfaxacmnvx p {
  margin: 0;
  padding: 0;
}

#tfaxacmnvx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tfaxacmnvx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tfaxacmnvx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tfaxacmnvx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tfaxacmnvx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tfaxacmnvx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tfaxacmnvx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tfaxacmnvx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tfaxacmnvx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tfaxacmnvx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tfaxacmnvx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tfaxacmnvx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tfaxacmnvx .gt_spanner_row {
  border-bottom-style: hidden;
}

#tfaxacmnvx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tfaxacmnvx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tfaxacmnvx .gt_from_md > :first-child {
  margin-top: 0;
}

#tfaxacmnvx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tfaxacmnvx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tfaxacmnvx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tfaxacmnvx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tfaxacmnvx .gt_row_group_first td {
  border-top-width: 2px;
}

#tfaxacmnvx .gt_row_group_first th {
  border-top-width: 2px;
}

#tfaxacmnvx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tfaxacmnvx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tfaxacmnvx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tfaxacmnvx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tfaxacmnvx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tfaxacmnvx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tfaxacmnvx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tfaxacmnvx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tfaxacmnvx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tfaxacmnvx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tfaxacmnvx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tfaxacmnvx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tfaxacmnvx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tfaxacmnvx .gt_left {
  text-align: left;
}

#tfaxacmnvx .gt_center {
  text-align: center;
}

#tfaxacmnvx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tfaxacmnvx .gt_font_normal {
  font-weight: normal;
}

#tfaxacmnvx .gt_font_bold {
  font-weight: bold;
}

#tfaxacmnvx .gt_font_italic {
  font-style: italic;
}

#tfaxacmnvx .gt_super {
  font-size: 65%;
}

#tfaxacmnvx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tfaxacmnvx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tfaxacmnvx .gt_indent_1 {
  text-indent: 5px;
}

#tfaxacmnvx .gt_indent_2 {
  text-indent: 10px;
}

#tfaxacmnvx .gt_indent_3 {
  text-indent: 15px;
}

#tfaxacmnvx .gt_indent_4 {
  text-indent: 20px;
}

#tfaxacmnvx .gt_indent_5 {
  text-indent: 25px;
}

#tfaxacmnvx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tfaxacmnvx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id=".model" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.model</th>
<th id="FullDate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">FullDate</th>
<th id="Cost of Sales (In Millions)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Cost of Sales (In Millions)</th>
<th id=".mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">.mean</th>
<th id="95%" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95%</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q2</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1532, 7662)</td>
<td class="gt_row gt_right" headers=".mean">1532.371</td>
<td class="gt_row gt_center" headers="95%">[1360.81323979361, 1703.92967921331]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q3</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1811, 7983)</td>
<td class="gt_row gt_right" headers=".mean">1811.283</td>
<td class="gt_row gt_center" headers="95%">[1636.16728545879, 1986.39853053419]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q4</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1805, 8351)</td>
<td class="gt_row gt_right" headers=".mean">1805.500</td>
<td class="gt_row gt_center" headers="95%">[1626.39319352741, 1984.60663056273]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q1</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1830, 8588)</td>
<td class="gt_row gt_right" headers=".mean">1830.267</td>
<td class="gt_row gt_center" headers="95%">[1648.63322919581, 2011.9012928529]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q2</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1718, 9559)</td>
<td class="gt_row gt_right" headers=".mean">1717.648</td>
<td class="gt_row gt_center" headers="95%">[1526.01981030487, 1909.27619032919]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q3</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(2002, 10187)</td>
<td class="gt_row gt_right" headers=".mean">2002.222</td>
<td class="gt_row gt_center" headers="95%">[1804.40229056328, 2200.04118645405]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">TSLM2</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q4</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(2002, 10882)</td>
<td class="gt_row gt_right" headers=".mean">2002.101</td>
<td class="gt_row gt_center" headers="95%">[1797.6417663025, 2206.56029820921]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q2</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1394, 7270)</td>
<td class="gt_row gt_right" headers=".mean">1394.300</td>
<td class="gt_row gt_center" headers="95%">[1227.18914028872, 1561.41087024307]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q3</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1651, 8801)</td>
<td class="gt_row gt_right" headers=".mean">1650.841</td>
<td class="gt_row gt_center" headers="95%">[1466.96575863004, 1834.71685349592]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q4</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1594, 11078)</td>
<td class="gt_row gt_right" headers=".mean">1594.166</td>
<td class="gt_row gt_center" headers="95%">[1387.87482549221, 1800.45626744804]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q1</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1617, 12332)</td>
<td class="gt_row gt_right" headers=".mean">1617.467</td>
<td class="gt_row gt_center" headers="95%">[1399.81087588345, 1835.12250481452]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q2</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1446, 14871)</td>
<td class="gt_row gt_right" headers=".mean">1445.784</td>
<td class="gt_row gt_center" headers="95%">[1206.77149974836, 1684.79619287632]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q3</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1700, 16134)</td>
<td class="gt_row gt_right" headers=".mean">1700.445</td>
<td class="gt_row gt_center" headers="95%">[1451.48751500662, 1949.40292240479]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">ARIMA</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q4</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1647, 17279)</td>
<td class="gt_row gt_right" headers=".mean">1646.647</td>
<td class="gt_row gt_center" headers="95%">[1389.01125651997, 1904.28318437619]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q2</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1402, 10669)</td>
<td class="gt_row gt_right" headers=".mean">1402.412</td>
<td class="gt_row gt_center" headers="95%">[1199.96390438173, 1604.85974076864]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q3</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1633, 19024)</td>
<td class="gt_row gt_right" headers=".mean">1632.516</td>
<td class="gt_row gt_center" headers="95%">[1362.18076023152, 1902.85052457189]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q4</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1591, 24491)</td>
<td class="gt_row gt_right" headers=".mean">1590.645</td>
<td class="gt_row gt_center" headers="95%">[1283.91848901443, 1897.37152846756]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q1</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1560, 29864)</td>
<td class="gt_row gt_right" headers=".mean">1559.750</td>
<td class="gt_row gt_center" headers="95%">[1221.04389072817, 1898.45683977983]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q2</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1402, 33024)</td>
<td class="gt_row gt_right" headers=".mean">1402.412</td>
<td class="gt_row gt_center" headers="95%">[1046.23808716779, 1758.58555798259]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q3</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1633, 41430)</td>
<td class="gt_row gt_right" headers=".mean">1632.516</td>
<td class="gt_row gt_center" headers="95%">[1233.57518788673, 2031.45609691668]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">ETS</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q4</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1591, 46949)</td>
<td class="gt_row gt_right" headers=".mean">1590.645</td>
<td class="gt_row gt_center" headers="95%">[1165.96604408291, 2015.32397339907]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">Combo</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q2</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1519, 7471)</td>
<td class="gt_row gt_right" headers=".mean">1519.375</td>
<td class="gt_row gt_center" headers="95%">[1349.96741497482, 1688.78357664645]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">Combo</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q3</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1793, 8235)</td>
<td class="gt_row gt_right" headers=".mean">1793.406</td>
<td class="gt_row gt_center" headers="95%">[1615.54634129935, 1971.26602157467]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">Combo</td>
<td class="gt_row gt_center" headers="FullDate">2024 Q4</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1784, 8841)</td>
<td class="gt_row gt_right" headers=".mean">1784.014</td>
<td class="gt_row gt_center" headers="95%">[1599.72545894822, 1968.3033844811]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">Combo</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q1</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1803, 9307)</td>
<td class="gt_row gt_right" headers=".mean">1803.216</td>
<td class="gt_row gt_center" headers="95%">[1614.13699703838, 1992.29414585626]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">Combo</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q2</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1686, 10349)</td>
<td class="gt_row gt_right" headers=".mean">1686.124</td>
<td class="gt_row gt_center" headers="95%">[1486.73492631119, 1885.51383877451]95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".model">Combo</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q3</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1965, 11297)</td>
<td class="gt_row gt_right" headers=".mean">1965.251</td>
<td class="gt_row gt_center" headers="95%">[1756.92837847104, 2173.57387932489]95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".model">Combo</td>
<td class="gt_row gt_center" headers="FullDate">2025 Q4</td>
<td class="gt_row gt_center" headers="Cost of Sales (In Millions)">N(1961, 12180)</td>
<td class="gt_row gt_right" headers=".mean">1960.955</td>
<td class="gt_row gt_center" headers="95%">[1744.65155841261, 2177.25930139612]95</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fitC2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(TSLM2) <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">7</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">level=</span><span class="dv">95</span>) <span class="sc">+</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(data_ts, <span class="st">`</span><span class="at">Cost of Sales (In Millions)</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_clean</span>() <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hershey's Projected Cost of Sales for 2024/2025"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hershey_files/figure-html/unnamed-chunk-7-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The forecast of our model shows a decrease in the cost of sales in 2024 Q2 and 2025 Q2 and spikes in the cost of sales in holiday-heavy quarters like Q3 2024 and Q3 2025. This may reflect a relaxed sales cost strategy to compliment relaxed sales in the off holiday season.</p>
<ul>
<li>Q2 2024: Cost of Sales $1532.371 M &lt;-Low 2024</li>
<li>Q3 2024: Cost of Sales $1811.283 M &lt;- High 2024</li>
<li>Q4 2024: Cost of Sales $1805.500 M</li>
<li>Q1 2025: Cost of Sales $1830.267 M</li>
<li>Q2 2025: Cost of Sales $1717.648 M &lt;- Low 2025</li>
<li>Q3 2025: Cost of Sales $2002.222 M &lt;- High 2024</li>
<li>Q4 2025: Cost of Sales $2002.101 M</li>
</ul>
</section>
<section id="results-and-business-impact" class="level3">
<h3 class="anchored" data-anchor-id="results-and-business-impact">5. Results and Business Impact</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.pinimg.com/originals/67/86/c8/6786c8b30c15d04beb04ccb6ece5fb04.jpg" class="centre img-fluid figure-img" style="width:30.0%"></p>
<figcaption>Seasonal Trends in Q3 and Q4</figcaption>
</figure>
</div>
<p><strong>Forecasting Results:</strong> In summary, our team discovered that there is a seasonal trend in the net sales and cost of sales of Hershey’s products. Using a Combination model to predict Net Sales TSLM2 model to predict Cost of Sales, both models reflected that sales and costs peak in Q3 and slump in Q2. The seasonal trend reflects a spike of sales in the holiday heavy months in Q3 and Q4, a moderate sales in Q1, and a slump in the summertime months during Q2. This reflects increase chocolate sales and costs of operations that correlate with holidays like Halloween, Christmas, and Valentines Day.</p>
<p>The forecasting values for Net Sales and Cost of Sales:</p>
<ul>
<li>Q2 2024: Cost of Sales $1532.371 M Net Sales $2796.881 M</li>
<li>Q3 2024: Cost of Sales $1811.283 M Net Sales $3282.364 M</li>
<li>Q4 2024: Cost of Sales $1,805.500 M Net Sales $3167.744 M</li>
<li>Q1 2025: Cost of Sales $1830.267 M Net Sales $3439.584 M</li>
<li>Q2 2025: Cost of Sales $1717.648 M Net Sales $3112.232 M</li>
<li>Q3 2025: Cost of Sales $2002.222 M Net Sales $3607.611 M</li>
<li>Q4 2025: Cost of Sales $2002.101 M Net Sales $3501.091 M</li>
</ul>
<p><strong>Implications for the Company:</strong> With this information, we recommend that Hershey continue to decrease its cost of sales of chocolate products in Q2 and increase its cost of sales in Q3 and Q4 to reflect consumer demand. Additionally, we have seen improved sales in Q1, and the cost of sales should be increased to try to increase sales in this period. Alternatively, Hershey could use this information to create a new sales or marketing strategy to increase sales in the dips of Q2.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>